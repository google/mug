<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (24) on Sat Jul 12 23:36:55 PDT 2025 -->
<title>ParameterizedQuery (mug-root 9.2-SNAPSHOT API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2025-07-12">
<meta name="description" content="declaration: package: com.google.mu.spanner, class: ParameterizedQuery">
<meta name="generator" content="javadoc/ClassWriter">
<link rel="stylesheet" type="text/css" href="../../../../resource-files/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../resource-files/stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script-files/script.js"></script>
<script type="text/javascript" src="../../../../script-files/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../script-files/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">const pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="nav-content">
<div class="nav-menu-button"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button></div>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/ParameterizedQuery.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../search.html">Search</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
</div>
<div class="sub-nav">
<div class="nav-content">
<ol class="sub-nav-list">
<li><a href="package-summary.html">com.google.mu.spanner</a></li>
<li><a href="ParameterizedQuery.html" class="current-selection">ParameterizedQuery</a></li>
</ol>
<div class="nav-list-search">
<input type="text" id="search-input" disabled placeholder="Search" aria-label="Search in documentation" autocomplete="off">
<input type="reset" id="reset-search" disabled value="Reset">
</div>
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="main-grid">
<nav role="navigation" class="toc" aria-label="Table of contents">
<div class="toc-header">Contents&nbsp;
<input type="text" class="filter-input" disabled placeholder="Filter" aria-label="Filter table of contents" autocomplete="off">
<input type="reset" class="reset-filter" disabled value="Reset">
</div>
<button class="hide-sidebar"><span>Hide sidebar&nbsp;</span>&#10094;</button><button class="show-sidebar">&#10095;<span>&nbsp;Show sidebar</span></button>
<ol class="toc-list">
<li><a href="#" tabindex="0">Description</a></li>
<li><a href="#field-summary" tabindex="0">Field Summary</a></li>
<li><a href="#method-summary" tabindex="0">Method Summary</a></li>
<li><a href="#field-detail" tabindex="0">Field Details</a>
<ol class="toc-list">
<li><a href="#EMPTY" tabindex="0">EMPTY</a></li>
</ol>
</li>
<li><a href="#method-detail" tabindex="0">Method Details</a>
<ol class="toc-list">
<li><a href="#of(java.lang.String,java.lang.Object...)" tabindex="0">of(String, Object...)</a></li>
<li><a href="#when(boolean,java.lang.String,java.lang.Object...)" tabindex="0">when(boolean, String, Object...)</a></li>
<li><a href="#when(boolean)" tabindex="0">when(boolean)</a></li>
<li><a href="#and()" tabindex="0">and()</a></li>
<li><a href="#or()" tabindex="0">or()</a></li>
<li><a href="#joining(java.lang.String)" tabindex="0">joining(String)</a></li>
<li><a href="#orElse(java.lang.String,java.lang.Object...)" tabindex="0">orElse(String, Object...)</a></li>
<li><a href="#orElse(com.google.mu.spanner.ParameterizedQuery)" tabindex="0">orElse(ParameterizedQuery)</a></li>
<li><a href="#orElse(java.util.function.Supplier)" tabindex="0">orElse(Supplier)</a></li>
<li><a href="#statement()" tabindex="0">statement()</a></li>
<li><a href="#toString()" tabindex="0">toString()</a></li>
<li><a href="#hashCode()" tabindex="0">hashCode()</a></li>
<li><a href="#equals(java.lang.Object)" tabindex="0">equals(Object)</a></li>
</ol>
</li>
</ol>
</nav>
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<h1 title="Class ParameterizedQuery" class="title">Class ParameterizedQuery</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">com.google.mu.spanner.ParameterizedQuery</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="horizontal-scroll">
<div class="type-signature"><span class="annotations">@Immutable
</span><span class="modifiers">public final class </span><span class="element-name type-name-label">ParameterizedQuery</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">An injection-safe SQL template for Google Cloud Spanner.

 <p>Spanner SQL is constructed using compile-time enforced templates, with support for dynamic SQL
 and flexible subquery composition. The library manages the parameterized query and the query
 parameters automatically, across all subqueries.

 <p>Use this class to create Spanner SQL template with parameters, to compose subqueries,
 and even to parameterize by identifiers (table names, column names), without risking injection.
 For example: <pre><code>
 List&lt;String&gt; groupColumns = ...;
 ParameterizedQuery query = ParameterizedQuery.of(
     """
     SELECT `{group_columns}`, SUM(revenue) AS revenue
     FROM Sales
     WHERE sku = '{sku}'
     GROUP BY `{group_columns}`
     """,
     groupColumns, sku, groupColumns);
 try (ResultSet resultSet = dbClient.singleUse().executeQuery(query.statement())) {
   ...
 }
 </code></pre>

 <p>If a placeholder is quoted by backticks (`) or double quotes, it's interpreted and
 validated as an identifier; all other placeholder values (except `ParameterizedQuery` objects,
 which are subqueries) are passed through Spanner's parameterization query.

 <p>To be explicit, a compile-time check is in place to require all non-identifier string
 placeholders to be single-quoted: this makes the template more self-evident, and helps to avoid
 the mistake of forgetting the quotes and then sending the column name as a query parameter.

 <p>Except the placeholders, everything outside the curly braces are strictly WYSIWYG
 (what you see is what you get), so you can copy paste them between the Java code and your SQL
 console for quick testing and debugging.

 <dl><dt><STRONG>Compile-time Protection</STRONG></dt></dl>

 <p>The templating engine uses compile-time checks to guard against accidental use of
 untrusted strings in the SQL, ensuring that they can only be sent as Spanner query parameters:
 try to use a dynamically generated String as the SQL template and you'll get a compilation error.

 <p>In addition, the same set of compile-time guardrails from the <a href="../util/StringFormat.html" title="class in com.google.mu.util"><code>StringFormat</code></a> class
 are in effect to make sure that you don't pass <code>lastName</code> in the place of
 <code>first_name</code>, for example.

 <p>To enable the compile-time plugin, copy the <code>&lt;annotationProcessorPaths&gt;</code> in the
 "maven-compiler-plugin" section from the following pom.xml file snippet:

 <pre><code>
 &lt;build&gt;
   &lt;pluginManagement&gt;
     &lt;plugins&gt;
       &lt;plugin&gt;
         &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
         &lt;configuration&gt;
           &lt;annotationProcessorPaths&gt;
             &lt;path&gt;
               &lt;groupId&gt;com.google.errorprone&lt;/groupId&gt;
               &lt;artifactId&gt;error_prone_core&lt;/artifactId&gt;
               &lt;version&gt;2.23.0&lt;/version&gt;
             &lt;/path&gt;
             &lt;path&gt;
               &lt;groupId&gt;com.google.mug&lt;/groupId&gt;
               &lt;artifactId&gt;mug-errorprone&lt;/artifactId&gt;
               &lt;version&gt;9.1&lt;/version&gt;
             &lt;/path&gt;
           &lt;/annotationProcessorPaths&gt;
         &lt;/configuration&gt;
       &lt;/plugin&gt;
     &lt;/plugins&gt;
   &lt;/pluginManagement&gt;
 &lt;/build&gt;
 </code></pre>

 <dl><dt><STRONG>Conditional Subqueries</STRONG></dt></dl>

 ParameterizedQuery's template syntax is designed to avoid control flows that could obfuscate SQL.
 Instead, complex control flow such as <code>if-else</code>, nested <code>if</code>, loops etc. should be
 performed in Java and passed in as subqueries.

 <p>Simple conditional subqueries (e.g. selecting a column if a flag is enabled) can use the
 guard operator <code>-&gt;</code> inside template placeholders:

 <pre><code>
   ParameterizedQuery sql = ParameterizedQuery.of(
       "SELECT {shows_email -&gt; email,} name FROM Users", showsEmail());
 </code></pre>

 The query text after the <code>-&gt;</code> operator is the conditional subquery that's only included if
 <code>showEmail()</code> returns true. The subquery can include arbitrary characters except curly
 braces, so you can also have multi-line conditional subqueries.

 <p>The <code>-&gt;</code> guard operator can also be used for <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Optional.html" title="class or interface in java.util" class="external-link"><code>Optional</code></a> parameters such that
 the right-hand-side SQL will only render if the optional value is present.

 <p>For example, the following code builds SQL to query the Users table with flexible
 number of columns and a flexible WHERE clause depending on the <code>UserCriteria</code>
 object's state:

 <pre><code>
   class UserCriteria {
     Optional&lt;String&gt; userId();
     Optional&lt;String&gt; firstName();
     ...
   }

   ParameterizedQuery usersQuery(UserCriteria criteria, @CompileTimeConstant String... columns) {
     return ParameterizedQuery.of(
         """
         SELECT `{columns}`
         FROM Users
         WHERE 1 = 1
             {user_id? -&gt; AND id = user_id?}
             {first_name? -&gt; AND firstName = 'first_name?'}
         """,
         asList(columns),
         criteria.userId()),
         criteria.firstName());
   }
 </code></pre>

 <p>The special "{foo? -&gt; ...}" guard syntax informs the template engine that the
 right hand side query snippet is only rendered if the <code>Optional</code> parameter corresponding
 to the "foo?" placeholder is present, in which case the value of the Optional will be used in
 the right hand side snippet as if it were a regular template argument.

 <p>If <code>UserCriteria</code> has specified <code>firstName()</code> but <code>userId()</code> is
 unspecified (empty), the resulting SQL will look like:

 <pre><code>
   SELECT `email`, `lastName` FROM Users WHERE firstName = @first_name
 </code></pre>

 <dl><dt><STRONG>Complex Dynamic Subqueries</STRONG></dt></dl>

 By composing ParameterizedQuery objects that encapsulate subqueries, you can also parameterize by
 arbitrary sub-queries that are computed dynamically.

 <p>Imagine if you need to translate a user-facing structured search expression like
 <code>location:US AND name:jing OR status:active</code> into SQL. And you already have the search
 expression parser that turns the search expression into an AST (abstract syntax tree).
 The following code uses ParameterizedQuery template to turn it into a spanner SQL filter that
 can be used in a where clause to query Spanner for the results: <pre><code>

 // The AST
 interface Expression permits AndExpression, OrExpression, MatchExpression {}

 record AndExpression(Expression left, Expression right) implements Expression {}
 record OrExpression(Expression left, Expression right) implements Expression {}
 record MatchExpression(String field, String text) implements Expression {}

 // AST -&gt; ParameterizedQuery
 ParameterizedQuery toSqlFilter(Expression expression) {
   return switch (expression) {
     case MatchExpression(String field, String text) -&gt;
         ParameterizedQuery.of("`{field}` = '{text}'", field, text);
     case AndExpression(Expression left, Expression right) -&gt;
         ParameterizedQuery.of("({left}) AND ({right})", toSqlFilter(left), toSqlFilter(right));
     case OrExpression(Expression left, Expression right) -&gt;
         ParameterizedQuery.of("({left}) OR ({right})", toSqlFilter(left), toSqlFilter(right));
   };
 }

 ParameterizedQuery query = ParameterizedQuery.of(
     "SELECT * FROM Foos WHERE {filter}", toSqlFilter(expression));
 </code></pre>

 <dl><dt><STRONG>Parameterize by Column Names or Table Names</STRONG></dt></dl>

 Sometimes you may wish to parameterize by table names, column names etc.
 for which Spanner parameterization has no support.

 <p>The safe way to parameterize dynamic strings as <em>identifiers</em> is to backtick-quote
 their placeholders in the SQL template. For example: <pre><code>
   ParameterizedQuery.of("SELECT `{columns}` FROM Users", request.getColumns())
 </code></pre>
 The backticks tell ParameterizedQuery that the string is supposed to be an identifier (or a list of
 identifiers). ParameterizedQuery will sanity-check the string(s) to ensure injection safety.

 <p>In the above example, if <code>getColumns()</code> returns <code>["id", "age"]</code>, the genereated
 SQL will be:

 <pre><code>
   SELECT `id`, `age` FROM Users
 </code></pre>

 <p>That is, each individual string will be backtick-quoted and then joined by ", ".

 <dl><dt><STRONG>Enforce Identical Parameter</STRONG></dt></dl>

 <p>The compile-time check tries to be helpful and checks that if you use the
 same parameter name more than once in the template, the same value must be used for it.

 <p>So for example, if you are trying to generate a SQL that looks like: <pre><code>
   SELECT u.firstName, p.profileId
   FROM (SELECT firstName FROM Users WHERE id = 'foo') u,
        (SELECT profileId FROM Profiles WHERE userId = 'foo') p
 </code></pre>

 It'll be important to use the same user id for both subqueries. And you can use the following
 template to make sure of it at compile time: <pre><code>
   ParameterizedQuery sql = ParameterizedQuery.of(
       """
       SELECT u.firstName, p.profileId
       FROM (SELECT firstName FROM Users WHERE id = '{user_id}') u,
            (SELECT profileId FROM Profiles WHERE userId = '{user_id}') p
       """,
       userId, userId);
 </code></pre>

 If someone mistakenly passes in inconsistent ids, they'll get a compilation error.

 <p>That said, placeholder names used in different subqueries are completely independent.
 There is no risk of name clash. The template will ensure the final parameter name uniqueness.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>9.0</dd>
</dl>
</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static final <a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a></code></div>
<div class="col-second even-row-color"><code><a href="#EMPTY" class="member-name-link">EMPTY</a></code></div>
<div class="col-last even-row-color">
<div class="block">An empty SQL</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Collector.html" title="class or interface in java.util.stream" class="external-link">Collector</a><wbr>&lt;<a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a>, ?, <a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#and()" class="member-name-link">and</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">A collector that joins boolean query snippet using <code>AND</code> operator.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#equals(java.lang.Object)" class="member-name-link">equals</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;obj)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#hashCode()" class="member-name-link">hashCode</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Collector.html" title="class or interface in java.util.stream" class="external-link">Collector</a><wbr>&lt;<a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a>, ?, <a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#joining(java.lang.String)" class="member-name-link">joining</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;delimiter)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns a collector that joins ParameterizedQuery elements using <code>delimiter</code>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#of(java.lang.String,java.lang.Object...)" class="member-name-link">of</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;template,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>...&nbsp;params)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns <a href="ParameterizedQuery.html" title="class in com.google.mu.spanner"><code>ParameterizedQuery</code></a> using <code>template</code> and <code>params</code>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Collector.html" title="class or interface in java.util.stream" class="external-link">Collector</a><wbr>&lt;<a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a>, ?, <a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#or()" class="member-name-link">or</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">A collector that joins boolean query snippet using <code>OR</code> operator.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#orElse(com.google.mu.spanner.ParameterizedQuery)" class="member-name-link">orElse</a><wbr>(<a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a>&nbsp;fallback)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">If <code>this</code> query is empty (likely from a call to <a href="#when(boolean,java.lang.String,java.lang.Object...)"><code>when(boolean, java.lang.String, java.lang.Object...)</code></a>),
 returns the <code>fallback</code> query.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#orElse(java.lang.String,java.lang.Object...)" class="member-name-link">orElse</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;fallback,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>...&nbsp;params)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">If <code>this</code> query is empty (likely from a call to <a href="#when(boolean,java.lang.String,java.lang.Object...)"><code>when(boolean, java.lang.String, java.lang.Object...)</code></a>),
 returns the ParameterizedQuery produced from the <code>fallback</code> template and <code>args</code>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#orElse(java.util.function.Supplier)" class="member-name-link">orElse</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Supplier.html" title="class or interface in java.util.function" class="external-link">Supplier</a>&lt;<a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a>&gt;&nbsp;fallback)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">If <code>this</code> query is empty (likely from a call to <a href="#when(boolean,java.lang.String,java.lang.Object...)"><code>when(boolean, java.lang.String, java.lang.Object...)</code></a>),
 returns the query produced by the <code>fallback</code> supplier.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>com.google.cloud.spanner.Statement</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#statement()" class="member-name-link">statement</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Creates an equivalent <code>Statement</code> to be passed to Spanner.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#toString()" class="member-name-link">toString</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns the SQL text with the template parameters translated to named Spanner
 parameters, annotated with parameter values.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#when(boolean)" class="member-name-link">when</a><wbr>(boolean&nbsp;condition)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns this ParameterizedQuery if <code>condition</code> is true; otherwise returns <a href="#EMPTY"><code>EMPTY</code></a>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#when(boolean,java.lang.String,java.lang.Object...)" class="member-name-link">when</a><wbr>(boolean&nbsp;condition,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;template,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>...&nbsp;params)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">An optional query that's only rendered if <code>condition</code> is true; otherwise returns <a href="#EMPTY"><code>EMPTY</code></a>.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#clone--" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#finalize--" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#getClass--" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notify--" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notifyAll--" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait--" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait-long-" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait-long-int-" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="EMPTY">
<h3>EMPTY</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type"><a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a></span>&nbsp;<span class="element-name">EMPTY</span></div>
<div class="block">An empty SQL</div>
</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="of(java.lang.String,java.lang.Object...)">
<h3>of</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations"><a href="../annotations/TemplateFormatMethod.html" title="annotation interface in com.google.mu.annotations">@TemplateFormatMethod</a>
<a href="../annotations/TemplateStringArgsMustBeQuoted.html" title="annotation interface in com.google.mu.annotations">@TemplateStringArgsMustBeQuoted</a>
</span><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a></span>&nbsp;<span class="element-name">of</span><wbr><span class="parameters">(<a href="../annotations/TemplateString.html" title="annotation interface in com.google.mu.annotations">@TemplateString</a> @CompileTimeConstant
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;template,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>...&nbsp;params)</span></div>
<div class="block">Returns <a href="ParameterizedQuery.html" title="class in com.google.mu.spanner"><code>ParameterizedQuery</code></a> using <code>template</code> and <code>params</code>.

 <p>For example:

 <pre><code>
 List&lt;Long&gt; jobIds = ParameterizedQuery.of(
         "SELECT id FROM Jobs WHERE timestamp BETWEEN {start} AND {end}",
         startTime, endTime)
     .query(dataSource, Long.class);
 </code></pre></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>template</code> - the sql template</dd>
<dd><code>params</code> - The template parameters. Parameters that are themselves <a href="ParameterizedQuery.html" title="class in com.google.mu.spanner"><code>ParameterizedQuery</code></a> are
 considered trusted subqueries and are appended directly. Other types are passed through as
 Spanner query parameters, with one exception: when the corresponding placeholder
 is quoted by backticks like <code>`{columns}`</code>, its string parameter value
 (or <code>Iterable&lt;String&gt;</code> parameter value) are directly appended (quotes, backticks,
 backslash and other special characters are disallowed).
 This makes it easy to parameterize by table names, column names etc.</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="when(boolean,java.lang.String,java.lang.Object...)">
<h3>when</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations"><a href="../annotations/TemplateFormatMethod.html" title="annotation interface in com.google.mu.annotations">@TemplateFormatMethod</a>
<a href="../annotations/TemplateStringArgsMustBeQuoted.html" title="annotation interface in com.google.mu.annotations">@TemplateStringArgsMustBeQuoted</a>
</span><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a></span>&nbsp;<span class="element-name">when</span><wbr><span class="parameters">(boolean&nbsp;condition,
 <a href="../annotations/TemplateString.html" title="annotation interface in com.google.mu.annotations">@TemplateString</a> @CompileTimeConstant
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;template,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>...&nbsp;params)</span></div>
<div class="block">An optional query that's only rendered if <code>condition</code> is true; otherwise returns <a href="#EMPTY"><code>EMPTY</code></a>. It's for use cases where a subquery is only conditionally added, for example the
 following query will only include the userEmail column under super user mode:

 <pre><code>
 ParameterizedQuery query = ParameterizedQuery.of(
     "SELECT job_id, start_timestamp {user_email} FROM jobs",
     ParameterizedQuery.when(isSuperUser, ", user_email"));
 </code></pre></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>condition</code> - the guard condition to determine if <code>template</code> should be renderd</dd>
<dd><code>template</code> - the template to render if <code>condition</code> is true</dd>
<dd><code>params</code> - see <a href="#of(java.lang.String,java.lang.Object...)"><code>of(String, Object...)</code></a> for discussion on the template arguments</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="when(boolean)">
<h3>when</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a></span>&nbsp;<span class="element-name">when</span><wbr><span class="parameters">(boolean&nbsp;condition)</span></div>
<div class="block">Returns this ParameterizedQuery if <code>condition</code> is true; otherwise returns <a href="#EMPTY"><code>EMPTY</code></a>.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="and()">
<h3>and</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Collector.html" title="class or interface in java.util.stream" class="external-link">Collector</a>&lt;<a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a>, ?, <a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a>&gt;</span>&nbsp;<span class="element-name">and</span>()</div>
<div class="block">A collector that joins boolean query snippet using <code>AND</code> operator. The
 AND'ed sub-queries will be enclosed in pairs of parenthesis to avoid
 ambiguity. If the input is empty, the result will be "(1 = 1)".

 <p>Empty ParameterizedQuery elements are ignored and not joined.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="or()">
<h3>or</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Collector.html" title="class or interface in java.util.stream" class="external-link">Collector</a>&lt;<a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a>, ?, <a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a>&gt;</span>&nbsp;<span class="element-name">or</span>()</div>
<div class="block">A collector that joins boolean query snippet using <code>OR</code> operator. The
 OR'ed sub-queries will be enclosed in pairs of parenthesis to avoid
 ambiguity. If the input is empty, the result will be "(1 = 0)".

 <p>Empty ParameterizedQuery elements are ignored and not joined.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="joining(java.lang.String)">
<h3>joining</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Collector.html" title="class or interface in java.util.stream" class="external-link">Collector</a>&lt;<a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a>, ?, <a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a>&gt;</span>&nbsp;<span class="element-name">joining</span><wbr><span class="parameters">(@CompileTimeConstant
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;delimiter)</span></div>
<div class="block">Returns a collector that joins ParameterizedQuery elements using <code>delimiter</code>.

 <p>Empty ParameterizedQuery elements are ignored and not joined.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="orElse(java.lang.String,java.lang.Object...)">
<h3>orElse</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations"><a href="../annotations/TemplateFormatMethod.html" title="annotation interface in com.google.mu.annotations">@TemplateFormatMethod</a>
<a href="../annotations/TemplateStringArgsMustBeQuoted.html" title="annotation interface in com.google.mu.annotations">@TemplateStringArgsMustBeQuoted</a>
</span><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a></span>&nbsp;<span class="element-name">orElse</span><wbr><span class="parameters">(<a href="../annotations/TemplateString.html" title="annotation interface in com.google.mu.annotations">@TemplateString</a> @CompileTimeConstant
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;fallback,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>...&nbsp;params)</span></div>
<div class="block">If <code>this</code> query is empty (likely from a call to <a href="#when(boolean,java.lang.String,java.lang.Object...)"><code>when(boolean, java.lang.String, java.lang.Object...)</code></a>),
 returns the ParameterizedQuery produced from the <code>fallback</code> template and <code>args</code>.

 <p>Using this method, you can create a chain of optional queries like:

 <pre><code>
 ParameterizedQuery.of(
     """
     CREATE TABLE ...
     {cluster_by}
     """,
     when(enableCluster, "CLUSTER BY (`{cluster_columns}`)", clusterColumns)
         .orElse("-- no cluster"));
 </code></pre></div>
</div>
</section>
</li>
<li>
<section class="detail" id="orElse(com.google.mu.spanner.ParameterizedQuery)">
<h3>orElse</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a></span>&nbsp;<span class="element-name">orElse</span><wbr><span class="parameters">(<a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a>&nbsp;fallback)</span></div>
<div class="block">If <code>this</code> query is empty (likely from a call to <a href="#when(boolean,java.lang.String,java.lang.Object...)"><code>when(boolean, java.lang.String, java.lang.Object...)</code></a>),
 returns the <code>fallback</code> query.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="orElse(java.util.function.Supplier)">
<h3>orElse</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a></span>&nbsp;<span class="element-name">orElse</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Supplier.html" title="class or interface in java.util.function" class="external-link">Supplier</a>&lt;<a href="ParameterizedQuery.html" title="class in com.google.mu.spanner">ParameterizedQuery</a>&gt;&nbsp;fallback)</span></div>
<div class="block">If <code>this</code> query is empty (likely from a call to <a href="#when(boolean,java.lang.String,java.lang.Object...)"><code>when(boolean, java.lang.String, java.lang.Object...)</code></a>),
 returns the query produced by the <code>fallback</code> supplier.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="statement()">
<h3>statement</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">com.google.cloud.spanner.Statement</span>&nbsp;<span class="element-name">statement</span>()</div>
<div class="block">Creates an equivalent <code>Statement</code> to be passed to Spanner.

 <p>This is how ParameterizedQuery is eventually consumed.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="toString()">
<h3>toString</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">toString</span>()</div>
<div class="block">Returns the SQL text with the template parameters translated to named Spanner
 parameters, annotated with parameter values.</div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#toString--" title="class or interface in java.lang" class="external-link">toString</a></code>&nbsp;in class&nbsp;<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></code></dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="hashCode()">
<h3>hashCode</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">hashCode</span>()</div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#hashCode--" title="class or interface in java.lang" class="external-link">hashCode</a></code>&nbsp;in class&nbsp;<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></code></dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="equals(java.lang.Object)">
<h3>equals</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">equals</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;obj)</span></div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#equals-java.lang.Object-" title="class or interface in java.lang" class="external-link">equals</a></code>&nbsp;in class&nbsp;<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></code></dd>
</dl>
</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2025. All rights reserved.</small></p>
</footer>
</main>
</div>
</body>
</html>
