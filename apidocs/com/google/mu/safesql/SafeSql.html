<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (24) -->
<title>SafeSql (mug-root 9.9-SNAPSHOT API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="declaration: package: com.google.mu.safesql, class: SafeSql">
<meta name="generator" content="javadoc/ClassWriter">
<link rel="stylesheet" type="text/css" href="../../../../resource-files/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../resource-files/stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script-files/script.js"></script>
<script type="text/javascript" src="../../../../script-files/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../script-files/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">const pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="nav-content">
<div class="nav-menu-button"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button></div>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/SafeSql.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../search.html">Search</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
</div>
<div class="sub-nav">
<div class="nav-content">
<ol class="sub-nav-list">
<li><a href="package-summary.html">com.google.mu.safesql</a></li>
<li><a href="SafeSql.html" class="current-selection">SafeSql</a></li>
</ol>
<div class="nav-list-search">
<input type="text" id="search-input" disabled placeholder="Search" aria-label="Search in documentation" autocomplete="off">
<input type="reset" id="reset-search" disabled value="Reset">
</div>
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="main-grid">
<nav role="navigation" class="toc" aria-label="Table of contents">
<div class="toc-header">Contents&nbsp;
<input type="text" class="filter-input" disabled placeholder="Filter" aria-label="Filter table of contents" autocomplete="off">
<input type="reset" class="reset-filter" disabled value="Reset">
</div>
<button class="hide-sidebar"><span>Hide sidebar&nbsp;</span>&#10094;</button><button class="show-sidebar">&#10095;<span>&nbsp;Show sidebar</span></button>
<ol class="toc-list">
<li><a href="#" tabindex="0">Description</a></li>
<li><a href="#field-summary" tabindex="0">Field Summary</a></li>
<li><a href="#method-summary" tabindex="0">Method Summary</a></li>
<li><a href="#field-detail" tabindex="0">Field Details</a>
<ol class="toc-list">
<li><a href="#EMPTY" tabindex="0">EMPTY</a></li>
</ol>
</li>
<li><a href="#method-detail" tabindex="0">Method Details</a>
<ol class="toc-list">
<li><a href="#of(java.lang.String,java.lang.Object...)" tabindex="0">of(String, Object...)</a></li>
<li><a href="#nonNegativeLiteral(int)" tabindex="0">nonNegativeLiteral(int)</a></li>
<li><a href="#optionally(java.lang.String,java.util.Optional)" tabindex="0">optionally(String, Optional)</a></li>
<li><a href="#when(boolean,java.lang.String,java.lang.Object...)" tabindex="0">when(boolean, String, Object...)</a></li>
<li><a href="#when(boolean)" tabindex="0">when(boolean)</a></li>
<li><a href="#template(java.lang.String)" tabindex="0">template(String)</a></li>
<li><a href="#and()" tabindex="0">and()</a></li>
<li><a href="#or()" tabindex="0">or()</a></li>
<li><a href="#joining(java.lang.String)" tabindex="0">joining(String)</a></li>
<li><a href="#orElse(java.lang.String,java.lang.Object...)" tabindex="0">orElse(String, Object...)</a></li>
<li><a href="#orElse(com.google.mu.safesql.SafeSql)" tabindex="0">orElse(SafeSql)</a></li>
<li><a href="#orElse(java.util.function.Supplier)" tabindex="0">orElse(Supplier)</a></li>
<li><a href="#query(javax.sql.DataSource,java.lang.Class)" tabindex="0">query(DataSource, Class)</a></li>
<li><a href="#query(java.sql.Connection,java.lang.Class)" tabindex="0">query(Connection, Class)</a></li>
<li><a href="#query(javax.sql.DataSource,com.google.mu.safesql.SqlFunction)" tabindex="0">query(DataSource, SqlFunction)</a></li>
<li><a href="#query(javax.sql.DataSource,com.google.mu.safesql.StatementSettings,java.lang.Class)" tabindex="0">query(DataSource, StatementSettings, Class)</a></li>
<li><a href="#query(java.sql.Connection,com.google.mu.safesql.StatementSettings,java.lang.Class)" tabindex="0">query(Connection, StatementSettings, Class)</a></li>
<li><a href="#query(javax.sql.DataSource,com.google.mu.safesql.StatementSettings,com.google.mu.safesql.SqlFunction)" tabindex="0">query(DataSource, StatementSettings, SqlFunction)</a></li>
<li><a href="#query(java.sql.Connection,com.google.mu.safesql.StatementSettings,com.google.mu.safesql.SqlFunction)" tabindex="0">query(Connection, StatementSettings, SqlFunction)</a></li>
<li><a href="#query(java.sql.Connection,com.google.mu.safesql.SqlFunction)" tabindex="0">query(Connection, SqlFunction)</a></li>
<li><a href="#queryForOne(javax.sql.DataSource,java.lang.Class)" tabindex="0">queryForOne(DataSource, Class)</a></li>
<li><a href="#queryForOne(java.sql.Connection,java.lang.Class)" tabindex="0">queryForOne(Connection, Class)</a></li>
<li><a href="#queryForOne(javax.sql.DataSource,com.google.mu.safesql.SqlFunction)" tabindex="0">queryForOne(DataSource, SqlFunction)</a></li>
<li><a href="#queryForOne(java.sql.Connection,com.google.mu.safesql.SqlFunction)" tabindex="0">queryForOne(Connection, SqlFunction)</a></li>
<li><a href="#queryLazily(javax.sql.DataSource,java.lang.Class)" tabindex="0">queryLazily(DataSource, Class)</a></li>
<li><a href="#queryLazily(javax.sql.DataSource,com.google.mu.safesql.SqlFunction)" tabindex="0">queryLazily(DataSource, SqlFunction)</a></li>
<li><a href="#queryLazily(javax.sql.DataSource,com.google.mu.safesql.StatementSettings,java.lang.Class)" tabindex="0">queryLazily(DataSource, StatementSettings, Class)</a></li>
<li><a href="#queryLazily(javax.sql.DataSource,com.google.mu.safesql.StatementSettings,com.google.mu.safesql.SqlFunction)" tabindex="0">queryLazily(DataSource, StatementSettings, SqlFunction)</a></li>
<li><a href="#queryLazily(java.sql.Connection,java.lang.Class)" tabindex="0">queryLazily(Connection, Class)</a></li>
<li><a href="#queryLazily(java.sql.Connection,com.google.mu.safesql.SqlFunction)" tabindex="0">queryLazily(Connection, SqlFunction)</a></li>
<li><a href="#queryLazily(java.sql.Connection,com.google.mu.safesql.StatementSettings,java.lang.Class)" tabindex="0">queryLazily(Connection, StatementSettings, Class)</a></li>
<li><a href="#queryLazily(java.sql.Connection,com.google.mu.safesql.StatementSettings,com.google.mu.safesql.SqlFunction)" tabindex="0">queryLazily(Connection, StatementSettings, SqlFunction)</a></li>
<li><a href="#update(javax.sql.DataSource)" tabindex="0">update(DataSource)</a></li>
<li><a href="#update(javax.sql.DataSource,com.google.mu.safesql.StatementSettings)" tabindex="0">update(DataSource, StatementSettings)</a></li>
<li><a href="#update(java.sql.Connection)" tabindex="0">update(Connection)</a></li>
<li><a href="#update(java.sql.Connection,com.google.mu.safesql.StatementSettings)" tabindex="0">update(Connection, StatementSettings)</a></li>
<li><a href="#prepareStatement(java.sql.Connection)" tabindex="0">prepareStatement(Connection)</a></li>
<li><a href="#prepareToQuery(java.sql.Connection,java.lang.String,java.lang.Class)" tabindex="0">prepareToQuery(Connection, String, Class)</a></li>
<li><a href="#prepareToQuery(java.sql.Connection,java.lang.String,com.google.mu.safesql.SqlFunction)" tabindex="0">prepareToQuery(Connection, String, SqlFunction)</a></li>
<li><a href="#prepareToUpdate(java.sql.Connection,java.lang.String)" tabindex="0">prepareToUpdate(Connection, String)</a></li>
<li><a href="#prepareToBatch(java.sql.Connection,java.lang.String)" tabindex="0">prepareToBatch(Connection, String)</a></li>
<li><a href="#debugString()" tabindex="0">debugString()</a></li>
<li><a href="#args()" tabindex="0">args()</a></li>
<li><a href="#toString()" tabindex="0">toString()</a></li>
<li><a href="#hashCode()" tabindex="0">hashCode()</a></li>
<li><a href="#equals(java.lang.Object)" tabindex="0">equals(Object)</a></li>
</ol>
</li>
</ol>
</nav>
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<h1 title="Class SafeSql" class="title">Class SafeSql</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">com.google.mu.safesql.SafeSql</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="horizontal-scroll">
<div class="type-signature"><span class="annotations">@ThreadSafe
@CheckReturnValue
</span><span class="modifiers">public final class </span><span class="element-name type-name-label">SafeSql</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">An injection-safe <em>dynamic SQL</em>, constructed using compile-time enforced templates.

 <p>This class is intended to work with JDBC <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link"><code>Connection</code></a> API with parameters set through
 the <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#setObject(int,java.lang.Object)" title="class or interface in java.sql" class="external-link"><code>setObject()</code></a> method.
 The main use case though, is to be able to compose subqueries and leaf-level parameters with an
 intuitive templating API.

 <p>The syntax to create a SQL with JDBC parameters, and potentially with dynamic SQL arguments (such
 as column names) is as simple and intuitive as the following example: <pre><code>
 List&lt;String&gt; groupColumns = ...;
 SafeSql sql = SafeSql.of(
     """
     SELECT `{group_columns}`, SUM(revenue) AS revenue
     FROM Sales
     WHERE sku = {sku}
     GROUP BY `{group_columns}`
     """,
     groupColumns, sku, groupColumns);
 List&lt;RevenueRecord&gt; results = sql.query(dataSource, RevenueRecord.class);
 </code></pre>

 <p>By default, all placeholder values are passed as JDBC parameters, unless quoted by backticks
 (used by databases like BigQuery, Databricks) or double quotes (used by databases like Oracle,
 Microsoft SQL Server or PostgreSQL). These are validated and interpreted as identifiers.

 <p>In the above example, placeholder <code>sku</code> will be passed as JDBC parameter,
 whereas the backtick-quoted <code>groupColumns</code> string list will be validated and then
 used as identifiers.

 <p>Except the placeholders, everything outside the curly braces are strictly WYSIWYG
 (what you see is what you get), so you can copy paste them between the Java code and your SQL
 console for quick testing and debugging.

 <dl><dt><STRONG>The <code>IN</code> Operator</STRONG></dt></dl>

 A common dynamic SQL use case is to use the <code>IN</code> SQL operator:

 <pre><code>
   SafeSql sql = SafeSql.of(
       """
       SELECT id FROM Users
       WHERE firstName = {first_name} AND lastName IN ({last_names})
       """,
       firstName, lastNamesList);
   List&lt;Long&gt; ids = sql.query(dataSource, Long.class);
 </code></pre>

 In the above example if <code>firstName</code> is "Emma" and <code>lastNamesList</code> is
 <code>["Watson", "Lin"]</code>, the generated SQL will be: <pre><code>
   SELECT id FROM Employees
   WHERE firstName = ? AND lastName IN (?, ?)
 </code></pre>

 And the parameters will be set as: <pre><code>
   statement.setObject(1, "Emma");
   statement.setObject(2, "Watson");
   statement.setObject(3, "Lin");
 </code></pre>

 <dl><dt><STRONG>Compile-time Protection</STRONG></dt></dl>

 <p>The templating engine uses compile-time checks to guard against accidental use of
 untrusted strings in the SQL, ensuring that they can only be sent as parameters of
 PreparedStatement: try to use a dynamically generated String as the SQL template and
 you'll get a compilation error.

 <p>In addition, the same set of compile-time guardrails from the <a href="../util/StringFormat.html" title="class in com.google.mu.util"><code>StringFormat</code></a> class
 are in effect to make sure that you don't pass <code>lastName</code> in the place of
 <code>first_name</code>, for example.

 <p>To enable the compile-time plugin, copy the <code>&lt;annotationProcessorPaths&gt;</code> in the
 "maven-compiler-plugin" section from the following pom.xml file snippet:

 <pre><code>
 &lt;build&gt;
   &lt;pluginManagement&gt;
     &lt;plugins&gt;
       &lt;plugin&gt;
         &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
         &lt;configuration&gt;
           &lt;annotationProcessorPaths&gt;
             &lt;path&gt;
               &lt;groupId&gt;com.google.errorprone&lt;/groupId&gt;
               &lt;artifactId&gt;error_prone_core&lt;/artifactId&gt;
               &lt;version&gt;2.40.0&lt;/version&gt;
             &lt;/path&gt;
             &lt;path&gt;
               &lt;groupId&gt;com.google.mug&lt;/groupId&gt;
               &lt;artifactId&gt;mug-errorprone&lt;/artifactId&gt;
               &lt;version&gt;9.8&lt;/version&gt;
             &lt;/path&gt;
           &lt;/annotationProcessorPaths&gt;
         &lt;/configuration&gt;
       &lt;/plugin&gt;
     &lt;/plugins&gt;
   &lt;/pluginManagement&gt;
 &lt;/build&gt;
 </code></pre>

 <dl><dt><STRONG>Conditional Subqueries</STRONG></dt></dl>

 SafeSql's template syntax is designed to avoid control flows that could obfuscate SQL. Instead,
 complex control flow such as <code>if-else</code>, nested <code>if</code>, loops etc. should be performed
 in Java and passed in as subqueries.

 <p>Starting from v8.4, simple conditional subqueries (e.g. selecting a column if a flag is
 enabled) can use the guard operator <code>-&gt;</code> inside template placeholders:

 <pre><code>
   SafeSql sql = SafeSql.of(
       "SELECT {shows_email -&gt; email,} name FROM Users", showsEmail());
 </code></pre>

 The query text after the <code>-&gt;</code> operator is the conditional subquery that's only included if
 <code>showEmail()</code> returns true. The subquery can include arbitrary characters except curly
 braces, so you can also have multi-line conditional subqueries.

 <p>The <code>-&gt;</code> guard operator can also be used for <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link"><code>Optional</code></a> parameters such that
 the right-hand-side SQL will only render if the optional value is present.

 <p>For example, the following code builds SQL to query the Users table with flexible
 number of columns and a flexible WHERE clause depending on the <code>UserCriteria</code>
 object's state:

 <pre><code>
   class UserCriteria {
     Optional&lt;String&gt; userId();
     Optional&lt;String&gt; firstName();
     List&lt;String&gt; aliases();
     ...
   }

   SafeSql usersQuery(UserCriteria criteria, @CompileTimeConstant String... columns) {
     return SafeSql.of(
         """
         SELECT `{columns}`
         FROM Users
         WHERE 1 = 1
             {user_id? -&gt; AND id = user_id?}
             {first_name? -&gt; AND firstName LIKE '%first_name?%'}
             {aliases? -&gt; AND name IN (aliases?)}
         """,
         asList(columns),
         criteria.userId()),
         criteria.firstName(),
         criteria.aliases());
   }

   List&lt;User&gt; users = usersQuery(userCriteria, "email", "lastName")
       .query(dataSource, User.class);
 </code></pre>

 <p>The special "{foo? -&gt; ...}" guard syntax informs the template engine that the
 right hand side query snippet is only rendered if the <code>Optional</code> parameter corresponding
 to the "foo?" placeholder is present, or the <code>Collection</code> paameter corresponding to it
 isn't empty, in which case the value of the Optional or Collection will be used in
 the right hand side snippet as if it were a regular template argument.

 <p>If <code>UserCriteria</code> has specified <code>firstName()</code> but <code>userId()</code> is
 unspecified (empty), the resulting SQL will look like:

 <pre><code>
   SELECT `email`, `lastName` FROM Users WHERE firstName LIKE ?
 </code></pre>

 <p>And when you call <code>usersQuery.prepareStatement(connection)</code> or one of the similar
 convenience methods, <code>statement.setObject(1, "%" + criteria.firstName().get() + "%")</code>
 will be called to populate the PreparedStatement.

 <dl><dt><STRONG>Complex Dynamic Subqueries</STRONG></dt></dl>

 By composing SafeSql objects that encapsulate subqueries, you can parameterize by
 arbitrary sub-queries that are computed dynamically.

 <p>Imagine if you need to translate a user-facing structured search expression like
 <code>location:US AND name:jing OR status:active</code> into SQL. And you already have the search
 expression parser that turns the search expression into an AST (abstract syntax tree).
 The following code uses SafeSql template to turn it into SQL where clause that can be used to
 query the database for the results: <pre><code>

 // The AST
 interface Expression permits AndExpression, OrExpression, HasExpression {}

 record AndExpression(Expression left, Expression right) implements Expression {}
 record OrExpression(Expression left, Expression right) implements Expression {}
 record HasExpression(String field, String text) implements Expression {}

 // AST -&gt; SafeSql
 SafeSql toSqlFilter(Expression expression) {
   return switch (expression) {
     case HasExpression(String field, String text) -&gt;
         SafeSql.of("`{field}` LIKE '%{text}%'", field, text);
     case AndExpression(Expression left, Expression right) -&gt;
         SafeSql.of("({left}) AND ({right})", toSqlFilter(left), toSqlFilter(right));
     case OrExpression(Expression left, Expression right) -&gt;
         SafeSql.of("({left}) OR ({right})", toSqlFilter(left), toSqlFilter(right));
   };
 }

 SafeSql query = SafeSql.of("SELECT * FROM Foos WHERE {filter}", toSqlFilter(expression));
 </code></pre>

 <dl><dt><STRONG>Parameterize by Column Names or Table Names</STRONG></dt></dl>

 Sometimes you may wish to parameterize by table names, column names etc.
 for which JDBC parameterization has no support.

 <p>If the identifiers are compile-time string literals, you can wrap them using
 <code>SafeSql.of(COLUMN_NAME)</code>, which can then be composed as subqueries.
 But what if the identifier string is loaded from a resource file, or is specified by a
 request field?

 <p>Passing the string directly as a template parameter will only generate the JDBC
 <code>'?'</code> parameter in its place, which won't work (PreparedStatement can't parameterize
 identifiers); <code>SafeSql.of(theString)</code> will fail to compile because such strings are
 inherently dynamic and untrusted.

 <p>The safe way to parameterize dynamic strings as <em>identifiers</em> is to backtick-quote
 their placeholders in the SQL template (if you use Oracle, PostgreSQL that use double quotes for
 identifier, use double quotes instead). For example: <pre><code>
   SafeSql.of("SELECT `{columns}` FROM Users", request.getColumns())
 </code></pre>
 The backticks tell SafeSql that the string is supposed to be an identifier (or a list of
 identifiers). SafeSql will sanity-check the string(s) to ensure injection safety.

 <p>In the above example, if <code>getColumns()</code> returns <code>["id", "age"]</code>, the genereated
 SQL will be:

 <pre><code>
   SELECT `id`, `age` FROM Users
 </code></pre>

 <p>That is, each individual string will be backtick-quoted and then joined by ", ".

 <dl><dt><STRONG>The <code>LIKE</code> Operator</STRONG></dt></dl>

 <p>Note that with straight JDBC API, if you try to use the LIKE operator to match a user-provided
 substring, i.e. using <code>LIKE '%foo%'</code> to search for "foo", this seemingly intuitive
 syntax is actually incorect: <pre><code>
   String searchTerm = ...;
   PreparedStatement statement =
       connection.prepareStatement("SELECT id FROM Users WHERE firstName LIKE '%?%'");
   statement.setString(1, searchTerm);
 </code></pre>

 JDBC PreparedStatement considers the quoted question mark as a literal so the <code>setString()</code>
 call will fail. You'll need to use the following workaround: <pre><code>
   PreparedStatement statement =
       connection.prepareStatement("SELECT id FROM Users WHERE firstName LIKE ?");
   statement.setString(1, "%" + searchTerm + "%");
 </code></pre>

 And even then, if the <code>searchTerm</code> includes special characters like '%' or backslash ('\'),
 they'll be interepreted as wildcards and escape characters, opening it up to a form of minor
 SQL injection despite already using the parameterized SQL.

 <p>The SafeSql template protects you from this caveat. The most intuitive syntax does exactly
 what you'd expect (and it escapes special characters too): <pre><code>
   String searchTerm = ...;
   SafeSql sql = SafeSql.of(
       "SELECT id FROM Users WHERE firstName LIKE '%{search_term}%'", searchTerm);
   List&lt;Long&gt; ids = sql.query(dataSource, Long.class);
 </code></pre>

 <p><strong>Automatic Escaping: No Need for ESCAPE Clause</strong></p>

 <p>This means you <em>do not</em> need to (and in fact, must not) write SQL
 using <code>ESCAPE</code> clauses after <code>LIKE '%{foo}%'</code>. Any such attempt, as in:

 <pre><code>
   SELECT name FROM Users WHERE name LIKE '%{term}%' ESCAPE '\'
 </code></pre>

 <p>...will be rejected, because SafeSql already performs all necessary escaping internally
 and automatically uses <code>ESCAPE '^'</code>. In other words, LIKE <em>just works</em>.

 <p>This eliminates the need for developers to deal with brittle double-escaping
 (like <code>'\\'</code>), or any cross-dialect compatibility issues.
 The template is also more readable.

 <p>If you find yourself wanting to use <code>ESCAPE</code>, consider whether you are
 manually escaping strings that could instead be safely passed as-is to SafeSql's
 template system.

 <p>That said, this only applies when template placeholder is used in the LIKE string.
 You can use any valid SQL ESCAPE syntax if placeholder isn't used in the LIKE expression.

 <dl><dt><STRONG>Quote String Placeholders</STRONG></dt></dl>

 Even when you don't use the <code>LIKE</code> operator or the percent sign (%), it may still be
 more readable to quote the string placeholders just so the SQL template explicitly tells readers
 that the parameter is a string. The following template works with or without the quotes around
 the <code>{id}</code> placeholder:

 <pre><code>
   // Reads more clearly that the {id} is a string
   SafeSql sql = SafeSql.of("SELECT * FROM Users WHERE id = '{id}'", userId);
 </code></pre>

 <dl><dt><STRONG>Enforce Identical Parameter</STRONG></dt></dl>

 <p>The compile-time check tries to be helpful and checks that if you use the
 same parameter name more than once in the template, the same value must be used for it.

 <p>So for example, if you are trying to generate a SQL that looks like: <pre><code>
   SELECT u.firstName, p.profileId
   FROM (SELECT firstName FROM Users WHERE id = 'foo') u,
        (SELECT profileId FROM Profiles WHERE userId = 'foo') p
 </code></pre>

 It'll be important to use the same user id for both subqueries. And you can use the following
 template to make sure of it at compile time: <pre><code>
   SafeSql sql = SafeSql.of(
       """
       SELECT u.firstName, p.profileId
       FROM (SELECT firstName FROM Users WHERE id = '{user_id}') u,
            (SELECT profileId FROM Profiles WHERE userId = '{user_id}') p
       """,
       userId, userId);
 </code></pre>

 If someone mistakenly passes in inconsistent ids, they'll get a compilation error.

 <hr width="100%" size="2"></hr>

 <p><em>For Spring users:</em> you can delegate to <code>JdbcTemplate</code> by calling
 <a href="#toString()"><code>toString()</code></a> to get the SQL string and <a href="#args()"><code>args()</code></a> to get the JDBC arguments.

 <hr width="100%" size="2"></hr>

 <p>Immutable if the template parameters you pass to it are immutable.

 <p>Starting from v9.0, SafeSql is moved to the mug-safesql artifact, and no longer requires Guava
 as a dependency.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>8.2</dd>
</dl>
</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static final <a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a></code></div>
<div class="col-second even-row-color"><code><a href="#EMPTY" class="member-name-link">EMPTY</a></code></div>
<div class="col-last even-row-color">
<div class="block">An empty SQL</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button><button id="method-summary-table-tab6" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab6', 3)" class="table-tab">Deprecated Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Collector.html" title="class or interface in java.util.stream" class="external-link">Collector</a><wbr>&lt;<a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a>,<wbr>?,<wbr><a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#and()" class="member-name-link">and</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">A collector that joins boolean query snippet using <code>AND</code> operator.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#args()" class="member-name-link">args</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns a copy of the JDBC arguments.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#debugString()" class="member-name-link">debugString</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns a query string with the parameter values embedded for easier debugging (logging,
 testing, golden file etc.).</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#equals(java.lang.Object)" class="member-name-link">equals</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;obj)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#hashCode()" class="member-name-link">hashCode</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Collector.html" title="class or interface in java.util.stream" class="external-link">Collector</a><wbr>&lt;<a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a>,<wbr>?,<wbr><a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#joining(java.lang.String)" class="member-name-link">joining</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;delimiter)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns a collector that joins SafeSql elements using <code>delimiter</code>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4 method-summary-table-tab6"><code>static <a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4 method-summary-table-tab6"><code><a href="#nonNegativeLiteral(int)" class="member-name-link">nonNegativeLiteral</a><wbr>(int&nbsp;number)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4 method-summary-table-tab6">
<div class="block"><span class="deprecated-label">Deprecated.</span>
<div class="deprecation-comment">Prefer <code>OFFSET-FETCH</code> clause, which is parameterizable</div>
</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#of(java.lang.String,java.lang.Object...)" class="member-name-link">of</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;template,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>...&nbsp;params)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns <a href="SafeSql.html" title="class in com.google.mu.safesql"><code>SafeSql</code></a> using <code>template</code> and <code>params</code>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4 method-summary-table-tab6"><code>static <a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4 method-summary-table-tab6"><code><a href="#optionally(java.lang.String,java.util.Optional)" class="member-name-link">optionally</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;query,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;?&gt;&nbsp;param)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4 method-summary-table-tab6">
<div class="block"><span class="deprecated-label">Deprecated.</span>
<div class="deprecation-comment">Use <code>SafeSql.of("{foo? -&gt; OR foo?}", optionalFoo)</code> instead of
             <code>optionally("or {foo}", optionalFoo)</code> because the former allows
             you to reference <code>foo?</code> multiple times in the right hand side snippet.</div>
</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Collector.html" title="class or interface in java.util.stream" class="external-link">Collector</a><wbr>&lt;<a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a>,<wbr>?,<wbr><a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#or()" class="member-name-link">or</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">A collector that joins boolean query snippet using <code>OR</code> operator.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#orElse(com.google.mu.safesql.SafeSql)" class="member-name-link">orElse</a><wbr>(<a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a>&nbsp;fallback)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">If <code>this</code> query is empty (likely from a call to <a href="#optionally(java.lang.String,java.util.Optional)"><code>optionally(java.lang.String, java.util.Optional&lt;?&gt;)</code></a> or <a href="#when(boolean,java.lang.String,java.lang.Object...)"><code>when(boolean, java.lang.String, java.lang.Object...)</code></a>),
 returns the <code>fallback</code> query.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#orElse(java.lang.String,java.lang.Object...)" class="member-name-link">orElse</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;fallback,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>...&nbsp;params)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">If <code>this</code> query is empty (likely from a call to <a href="#optionally(java.lang.String,java.util.Optional)"><code>optionally(java.lang.String, java.util.Optional&lt;?&gt;)</code></a> or <a href="#when(boolean,java.lang.String,java.lang.Object...)"><code>when(boolean, java.lang.String, java.lang.Object...)</code></a>),
 returns the SafeSql produced from the <code>fallback</code> template and <code>args</code>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#orElse(java.util.function.Supplier)" class="member-name-link">orElse</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/function/Supplier.html" title="class or interface in java.util.function" class="external-link">Supplier</a>&lt;<a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a>&gt;&nbsp;fallback)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">If <code>this</code> query is empty (likely from a call to <a href="#optionally(java.lang.String,java.util.Optional)"><code>optionally(java.lang.String, java.util.Optional&lt;?&gt;)</code></a> or <a href="#when(boolean,java.lang.String,java.lang.Object...)"><code>when(boolean, java.lang.String, java.lang.Object...)</code></a>),
 returns the query produced by the <code>fallback</code> supplier.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html" title="class or interface in java.sql" class="external-link">PreparedStatement</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#prepareStatement(java.sql.Connection)" class="member-name-link">prepareStatement</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns a <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html" title="class or interface in java.sql" class="external-link"><code>PreparedStatement</code></a> with the encapsulated sql and parameters.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="../util/StringFormat.Template.html" title="interface in com.google.mu.util">StringFormat.Template</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html" title="class or interface in java.sql" class="external-link">PreparedStatement</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#prepareToBatch(java.sql.Connection,java.lang.String)" class="member-name-link">prepareToBatch</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;template)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns a DML (create, update, delete) template that will reuse the same cached <code>
 PreparedStatement</code> for repeated calls of <a href="../util/StringFormat.Template.html#with(java.lang.Object...)"><code>StringFormat.Template.with(java.lang.Object...)</code></a> to add <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#addBatch()" title="class or interface in java.sql" class="external-link"><code>batches</code></a></div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static &lt;T&gt;&nbsp;<a href="../util/StringFormat.Template.html" title="interface in com.google.mu.util">StringFormat.Template</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;T&gt;&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#prepareToQuery(java.sql.Connection,java.lang.String,com.google.mu.safesql.SqlFunction)" class="member-name-link">prepareToQuery</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;template,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns a query template that will reuse the same cached <code>PreparedStatement</code>
 for repeated calls of <a href="../util/StringFormat.Template.html#with(java.lang.Object...)"><code>StringFormat.Template.with(java.lang.Object...)</code></a> using different parameters.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static &lt;T&gt;&nbsp;<a href="../util/StringFormat.Template.html" title="interface in com.google.mu.util">StringFormat.Template</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;T&gt;&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#prepareToQuery(java.sql.Connection,java.lang.String,java.lang.Class)" class="member-name-link">prepareToQuery</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;template,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns a query template that will reuse the same cached <code>PreparedStatement</code>
 for repeated calls of <a href="../util/StringFormat.Template.html#with(java.lang.Object...)"><code>StringFormat.Template.with(java.lang.Object...)</code></a> using different parameters.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="../util/StringFormat.Template.html" title="interface in com.google.mu.util">StringFormat.Template</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#prepareToUpdate(java.sql.Connection,java.lang.String)" class="member-name-link">prepareToUpdate</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;template)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns a DML (create, update, delete) template that will reuse the same cached <code>
 PreparedStatement</code> for repeated calls of <a href="../util/StringFormat.Template.html#with(java.lang.Object...)"><code>StringFormat.Template.with(java.lang.Object...)</code></a> using different parameters.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;T&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#query(java.sql.Connection,com.google.mu.safesql.SqlFunction)" class="member-name-link">query</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Similar to <a href="#query(javax.sql.DataSource,com.google.mu.safesql.SqlFunction)"><code>query(DataSource, SqlFunction)</code></a>, but uses an existing connection.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;T&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#query(java.sql.Connection,com.google.mu.safesql.StatementSettings,com.google.mu.safesql.SqlFunction)" class="member-name-link">query</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="StatementSettings.html" title="interface in com.google.mu.safesql">StatementSettings</a>&nbsp;settings,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Similar to <a href="#query(javax.sql.DataSource,com.google.mu.safesql.StatementSettings,com.google.mu.safesql.SqlFunction)"><code>query(DataSource, StatementSettings, SqlFunction)</code></a>, but uses an existing connection.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;T&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#query(java.sql.Connection,com.google.mu.safesql.StatementSettings,java.lang.Class)" class="member-name-link">query</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="StatementSettings.html" title="interface in com.google.mu.safesql">StatementSettings</a>&nbsp;settings,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Similar to <a href="#query(javax.sql.DataSource,com.google.mu.safesql.StatementSettings,java.lang.Class)"><code>query(DataSource, StatementSettings, Class)</code></a>, but uses an existing connection.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;T&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#query(java.sql.Connection,java.lang.Class)" class="member-name-link">query</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Similar to <a href="#query(javax.sql.DataSource,java.lang.Class)"><code>query(DataSource, Class)</code></a>, but uses an existing connection.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;T&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#query(javax.sql.DataSource,com.google.mu.safesql.SqlFunction)" class="member-name-link">query</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Executes the encapsulated SQL as a query against <code>dataSource.getConnection()</code>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;T&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#query(javax.sql.DataSource,com.google.mu.safesql.StatementSettings,com.google.mu.safesql.SqlFunction)" class="member-name-link">query</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="StatementSettings.html" title="interface in com.google.mu.safesql">StatementSettings</a>&nbsp;settings,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Executes the encapsulated SQL as a query against <code>dataSource.getConnection()</code>,
 using <code>settings</code> (can be set via lambda like <code>stmt -&gt; stmt.setMaxRows(100)</code>).</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;T&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#query(javax.sql.DataSource,com.google.mu.safesql.StatementSettings,java.lang.Class)" class="member-name-link">query</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="StatementSettings.html" title="interface in com.google.mu.safesql">StatementSettings</a>&nbsp;settings,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Similar to <a href="#query(javax.sql.DataSource,java.lang.Class)"><code>query(DataSource, Class)</code></a>, but with <code>settings</code>
 (can be set via lambda like <code>stmt -&gt; stmt.setMaxRows(100)</code>)
 to allow customization.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;T&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#query(javax.sql.DataSource,java.lang.Class)" class="member-name-link">query</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Executes the encapsulated SQL as a query against <code>dataSource.getConnection()</code>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a><wbr>&lt;T&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#queryForOne(java.sql.Connection,com.google.mu.safesql.SqlFunction)" class="member-name-link">queryForOne</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Similar to <a href="#query(java.sql.Connection,com.google.mu.safesql.SqlFunction)"><code>query(Connection, SqlFunction)</code></a>, but only fetches one row if the query
 result includes at least one rows, or else returns <code>Optional.empty()</code>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a><wbr>&lt;T&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#queryForOne(java.sql.Connection,java.lang.Class)" class="member-name-link">queryForOne</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Similar to <a href="#query(java.sql.Connection,java.lang.Class)"><code>query(Connection, Class)</code></a>, but only fetches one row if the query
 result includes at least one rows, or else returns <code>Optional.empty()</code>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a><wbr>&lt;T&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#queryForOne(javax.sql.DataSource,com.google.mu.safesql.SqlFunction)" class="member-name-link">queryForOne</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Similar to <a href="#query(javax.sql.DataSource,com.google.mu.safesql.SqlFunction)"><code>query(DataSource, SqlFunction)</code></a>, but only fetches one row if the query
 result includes at least one rows, or else returns <code>Optional.empty()</code>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a><wbr>&lt;T&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#queryForOne(javax.sql.DataSource,java.lang.Class)" class="member-name-link">queryForOne</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Similar to <a href="#query(javax.sql.DataSource,java.lang.Class)"><code>query(DataSource, Class)</code></a>, but only fetches one row if the query
 result includes at least one rows, or else returns <code>Optional.empty()</code>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link">Stream</a><wbr>&lt;T&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#queryLazily(java.sql.Connection,com.google.mu.safesql.SqlFunction)" class="member-name-link">queryLazily</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Executes the encapsulated SQL as a query against <code>connection</code>,
 and then fetches the results lazily in a stream.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link">Stream</a><wbr>&lt;T&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#queryLazily(java.sql.Connection,com.google.mu.safesql.StatementSettings,com.google.mu.safesql.SqlFunction)" class="member-name-link">queryLazily</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="StatementSettings.html" title="interface in com.google.mu.safesql">StatementSettings</a>&nbsp;settings,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Executes the encapsulated SQL as a query against <code>connection</code>, with <code>settings</code>
 (can be set via lambda like <code>stmt -&gt; stmt.setFetchSize(100)</code>, and then fetches the
 results lazily in a stream.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link">Stream</a><wbr>&lt;T&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#queryLazily(java.sql.Connection,com.google.mu.safesql.StatementSettings,java.lang.Class)" class="member-name-link">queryLazily</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="StatementSettings.html" title="interface in com.google.mu.safesql">StatementSettings</a>&nbsp;settings,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Executes the encapsulated SQL as a query against <code>connection</code>, with <code>settings</code>
 (can be set via lambda like <code>stmt -&gt; stmt.setFetchSize(100)</code>), and then fetches the
 results lazily in a stream.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link">Stream</a><wbr>&lt;T&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#queryLazily(java.sql.Connection,java.lang.Class)" class="member-name-link">queryLazily</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Executes the encapsulated SQL as a query against <code>connection</code>,
 and then fetches the results lazily in a stream.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link">Stream</a><wbr>&lt;T&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#queryLazily(javax.sql.DataSource,com.google.mu.safesql.SqlFunction)" class="member-name-link">queryLazily</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Executes the encapsulated SQL as a query against <code>connection</code>,
 and then fetches the results lazily in a stream.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link">Stream</a><wbr>&lt;T&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#queryLazily(javax.sql.DataSource,com.google.mu.safesql.StatementSettings,com.google.mu.safesql.SqlFunction)" class="member-name-link">queryLazily</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="StatementSettings.html" title="interface in com.google.mu.safesql">StatementSettings</a>&nbsp;settings,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Executes the encapsulated SQL as a query against <code>dataSource</code>, with <code>settings</code>
 (can be set via lambda like <code>stmt -&gt; stmt.setFetchSize(100)</code>, and then fetches the
 results lazily in a stream.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link">Stream</a><wbr>&lt;T&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#queryLazily(javax.sql.DataSource,com.google.mu.safesql.StatementSettings,java.lang.Class)" class="member-name-link">queryLazily</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="StatementSettings.html" title="interface in com.google.mu.safesql">StatementSettings</a>&nbsp;settings,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Executes the encapsulated SQL as a query against <code>connection</code>, with <code>settings</code>
 (can be set via lambda like <code>stmt -&gt; stmt.setFetchSize(100)</code>), and then fetches the
 results lazily in a stream.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link">Stream</a><wbr>&lt;T&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#queryLazily(javax.sql.DataSource,java.lang.Class)" class="member-name-link">queryLazily</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Executes the encapsulated SQL as a query against <code>connection</code>,
 and then fetches the results lazily in a stream.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="../util/StringFormat.Template.html" title="interface in com.google.mu.util">StringFormat.Template</a><wbr>&lt;<a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#template(java.lang.String)" class="member-name-link">template</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;template)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns a <a href="../util/StringFormat.Template.html" title="interface in com.google.mu.util"><code>StringFormat.Template</code></a> of <a href="SafeSql.html" title="class in com.google.mu.safesql"><code>SafeSql</code></a> based on the <code>template</code> string.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#toString()" class="member-name-link">toString</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns the SQL text with the template parameters translated to the JDBC <code>'?'</code>
 placeholders.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#update(java.sql.Connection)" class="member-name-link">update</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Executes the encapsulated DML (create, update, delete statements) against <code>connection</code>
 and returns the number of affected rows.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#update(java.sql.Connection,com.google.mu.safesql.StatementSettings)" class="member-name-link">update</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="StatementSettings.html" title="interface in com.google.mu.safesql">StatementSettings</a>&nbsp;settings)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Similar to <a href="#update(java.sql.Connection)"><code>update(Connection)</code></a>, but with <code>settings</code>
 (can be set via lambda like <code>stmt -&gt; stmt.setQueryTimeout(100)</code>)
 to allow customization.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#update(javax.sql.DataSource)" class="member-name-link">update</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Executes the encapsulated DML (create, update, delete statements) against <code>dataSource</code>
 and returns the number of affected rows.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#update(javax.sql.DataSource,com.google.mu.safesql.StatementSettings)" class="member-name-link">update</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="StatementSettings.html" title="interface in com.google.mu.safesql">StatementSettings</a>&nbsp;settings)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Similar to <a href="#update(javax.sql.DataSource)"><code>update(DataSource)</code></a>, but with <code>settings</code>
 (can be set via lambda like <code>stmt -&gt; stmt.setQueryTimeout(100)</code>)
 to allow customization.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#when(boolean)" class="member-name-link">when</a><wbr>(boolean&nbsp;condition)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns this SafeSql if <code>condition</code> is true; otherwise returns <a href="#EMPTY"><code>EMPTY</code></a>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#when(boolean,java.lang.String,java.lang.Object...)" class="member-name-link">when</a><wbr>(boolean&nbsp;condition,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;template,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>...&nbsp;params)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">An optional query that's only rendered if <code>condition</code> is true; otherwise returns <a href="#EMPTY"><code>EMPTY</code></a>.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="EMPTY">
<h3>EMPTY</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type"><a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a></span>&nbsp;<span class="element-name">EMPTY</span></div>
<div class="block">An empty SQL</div>
</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="of(java.lang.String,java.lang.Object...)">
<h3>of</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations"><a href="../annotations/TemplateFormatMethod.html" title="annotation interface in com.google.mu.annotations">@TemplateFormatMethod</a>
</span><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a></span>&nbsp;<span class="element-name">of</span><wbr><span class="parameters">(<a href="../annotations/TemplateString.html" title="annotation interface in com.google.mu.annotations">@TemplateString</a> @CompileTimeConstant
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;template,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>...&nbsp;params)</span></div>
<div class="block">Returns <a href="SafeSql.html" title="class in com.google.mu.safesql"><code>SafeSql</code></a> using <code>template</code> and <code>params</code>.

 <p>For example:

 <pre><code>
 List&lt;Long&gt; jobIds = SafeSql.of(
         "SELECT id FROM Jobs WHERE timestamp BETWEEN {start} AND {end}",
         startTime, endTime)
     .query(dataSource, Long.class);
 </code></pre>

 <p>Note that if you plan to create a <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html" title="class or interface in java.sql" class="external-link"><code>PreparedStatement</code></a> and use it multiple times
 with different sets of parameters, it's more efficient to use <a href="#prepareToQuery(java.sql.Connection,java.lang.String,java.lang.Class)"><code>prepareToQuery()</code></a> or <a href="#prepareToUpdate(java.sql.Connection,java.lang.String)"><code>prepareToUpdate()</code></a>, which will reuse the same
 PreparedStatement for multiple calls. The returned <a href="../util/StringFormat.Template.html" title="interface in com.google.mu.util"><code>StringFormat.Template</code></a>s are protected at
 compile-time against incorrect varargs.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>template</code> - the sql template</dd>
<dd><code>params</code> - The template parameters. Parameters that are themselves <a href="SafeSql.html" title="class in com.google.mu.safesql"><code>SafeSql</code></a> are
 considered trusted subqueries and are appended directly. Other types are passed through JDBC
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#setObject(int,java.lang.Object,int)" title="class or interface in java.sql" class="external-link"><code>PreparedStatement.setObject(int, java.lang.Object, int)</code></a>, with one exception: when the corresponding placeholder
 is quoted by backticks like <code>`{columns}`</code>, its string parameter value
 (or <code>Iterable&lt;String&gt;</code> parameter value) are directly appended (quotes, backticks,
 backslash and other special characters are disallowed).
 This makes it easy to parameterize by table names, column names etc.</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="nonNegativeLiteral(int)">
<h3>nonNegativeLiteral</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Deprecated.html" title="class or interface in java.lang" class="external-link">@Deprecated</a>
</span><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a></span>&nbsp;<span class="element-name">nonNegativeLiteral</span><wbr><span class="parameters">(int&nbsp;number)</span></div>
<div class="deprecation-block"><span class="deprecated-label">Deprecated.</span>
<div class="deprecation-comment">Prefer <code>OFFSET-FETCH</code> clause, which is parameterizable</div>
</div>
<div class="block">Wraps non-negative <code>number</code> as a literal SQL snippet in a SafeSql object.

 <p>For example, the following SQL Server query allows parameterization by the TOP n number:
 <pre><code>
   SafeSql.of("SELECT TOP {page_size} UserId FROM Users", nonNegativeLiteral(pageSize))
 </code></pre>

 <p>Needed because the SQL Server JDBC driver doesn't support parameterizing the TOP number
 through <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html" title="class or interface in java.sql" class="external-link"><code>PreparedStatement</code></a> API.

 <p>Although, you should generally use the OFFSET-FETCH syntax, which supports parameterization.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if <code>number</code> is negative</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="optionally(java.lang.String,java.util.Optional)">
<h3>optionally</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations"><a href="../annotations/TemplateFormatMethod.html" title="annotation interface in com.google.mu.annotations">@TemplateFormatMethod</a>
<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Deprecated.html" title="class or interface in java.lang" class="external-link">@Deprecated</a>
</span><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a></span>&nbsp;<span class="element-name">optionally</span><wbr><span class="parameters">(<a href="../annotations/TemplateString.html" title="annotation interface in com.google.mu.annotations">@TemplateString</a> @CompileTimeConstant
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;query,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;?&gt;&nbsp;param)</span></div>
<div class="deprecation-block"><span class="deprecated-label">Deprecated.</span>
<div class="deprecation-comment">Use <code>SafeSql.of("{foo? -&gt; OR foo?}", optionalFoo)</code> instead of
             <code>optionally("or {foo}", optionalFoo)</code> because the former allows
             you to reference <code>foo?</code> multiple times in the right hand side snippet.</div>
</div>
<div class="block">An optional query that's only rendered if <code>param</code> is present; otherwise returns <a href="#EMPTY"><code>EMPTY</code></a>. It's for use cases where a subquery is only added when present, for example the
 following query will add the WHERE clause if the filter is present:

 <pre><code>
 SafeSql query = SafeSql.of(
     "SELECT * FROM jobs {where}",
     SafeSql.optionally("WHERE {filter}", getOptionalWhereClause()));
 </code></pre></div>
</div>
</section>
</li>
<li>
<section class="detail" id="when(boolean,java.lang.String,java.lang.Object...)">
<h3>when</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations"><a href="../annotations/TemplateFormatMethod.html" title="annotation interface in com.google.mu.annotations">@TemplateFormatMethod</a>
</span><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a></span>&nbsp;<span class="element-name">when</span><wbr><span class="parameters">(boolean&nbsp;condition,
 <a href="../annotations/TemplateString.html" title="annotation interface in com.google.mu.annotations">@TemplateString</a> @CompileTimeConstant
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;template,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>...&nbsp;params)</span></div>
<div class="block">An optional query that's only rendered if <code>condition</code> is true; otherwise returns <a href="#EMPTY"><code>EMPTY</code></a>. It's for use cases where a subquery is only conditionally added, for example the
 following query will only include the userEmail column under super user mode:

 <pre><code>
 SafeSql query = SafeSql.of(
     "SELECT job_id, start_timestamp {user_email} FROM jobs",
     SafeSql.when(isSuperUser, ", user_email"));
 </code></pre></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>condition</code> - the guard condition to determine if <code>template</code> should be renderd</dd>
<dd><code>template</code> - the template to render if <code>condition</code> is true</dd>
<dd><code>params</code> - see <a href="#of(java.lang.String,java.lang.Object...)"><code>of(String, Object...)</code></a> for discussion on the template arguments</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="when(boolean)">
<h3>when</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a></span>&nbsp;<span class="element-name">when</span><wbr><span class="parameters">(boolean&nbsp;condition)</span></div>
<div class="block">Returns this SafeSql if <code>condition</code> is true; otherwise returns <a href="#EMPTY"><code>EMPTY</code></a>.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>8.4</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="template(java.lang.String)">
<h3>template</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="../util/StringFormat.Template.html" title="interface in com.google.mu.util">StringFormat.Template</a>&lt;<a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a>&gt;</span>&nbsp;<span class="element-name">template</span><wbr><span class="parameters">(@CompileTimeConstant
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;template)</span></div>
<div class="block">Returns a <a href="../util/StringFormat.Template.html" title="interface in com.google.mu.util"><code>StringFormat.Template</code></a> of <a href="SafeSql.html" title="class in com.google.mu.safesql"><code>SafeSql</code></a> based on the <code>template</code> string.
 Useful for creating a constant to be reused with different parameters.

 <p>For example:

 <pre><code>
 private static final Template&lt;SafeSql&gt; FIND_USERS_BY_NAME =
     SafeSql.template("SELECT `{columns}` FROM Users WHERE name LIKE '%{name}%'");

 String searchBy = ...;
 List&lt;User&gt; userIds = FIND_USERS_BY_NAME.with(asList("id", "name"), searchBy)
     .query(dataSource, User.class);
 </code></pre>

 <p>If you don't need a reusable template, consider using <a href="#of(java.lang.String,java.lang.Object...)"><code>of(java.lang.String, java.lang.Object...)</code></a> instead, which is simpler.

 <p>The template arguments follow the same rules as discussed in <a href="#of(java.lang.String,java.lang.Object...)"><code>of(String, Object...)</code></a>
 and receives the same compile-time protection against mismatch or out-of-order human mistakes,
 so it's safe to use the template as a constant.

 <p>The returned template is immutable and thread safe.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="and()">
<h3>and</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Collector.html" title="class or interface in java.util.stream" class="external-link">Collector</a>&lt;<a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a>,<wbr>?,<wbr><a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a>&gt;</span>&nbsp;<span class="element-name">and</span>()</div>
<div class="block">A collector that joins boolean query snippet using <code>AND</code> operator. The
 AND'ed sub-queries will be enclosed in pairs of parenthesis to avoid
 ambiguity. If the input is empty, the result will be "(1 = 1)".

 <p>Empty SafeSql elements are ignored and not joined.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="or()">
<h3>or</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Collector.html" title="class or interface in java.util.stream" class="external-link">Collector</a>&lt;<a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a>,<wbr>?,<wbr><a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a>&gt;</span>&nbsp;<span class="element-name">or</span>()</div>
<div class="block">A collector that joins boolean query snippet using <code>OR</code> operator. The
 OR'ed sub-queries will be enclosed in pairs of parenthesis to avoid
 ambiguity. If the input is empty, the result will be "(1 = 0)".

 <p>Empty SafeSql elements are ignored and not joined.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="joining(java.lang.String)">
<h3>joining</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Collector.html" title="class or interface in java.util.stream" class="external-link">Collector</a>&lt;<a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a>,<wbr>?,<wbr><a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a>&gt;</span>&nbsp;<span class="element-name">joining</span><wbr><span class="parameters">(@CompileTimeConstant
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;delimiter)</span></div>
<div class="block">Returns a collector that joins SafeSql elements using <code>delimiter</code>.

 <p>Empty SafeSql elements are ignored and not joined.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="orElse(java.lang.String,java.lang.Object...)">
<h3>orElse</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations"><a href="../annotations/TemplateFormatMethod.html" title="annotation interface in com.google.mu.annotations">@TemplateFormatMethod</a>
</span><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a></span>&nbsp;<span class="element-name">orElse</span><wbr><span class="parameters">(<a href="../annotations/TemplateString.html" title="annotation interface in com.google.mu.annotations">@TemplateString</a> @CompileTimeConstant
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;fallback,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>...&nbsp;params)</span></div>
<div class="block">If <code>this</code> query is empty (likely from a call to <a href="#optionally(java.lang.String,java.util.Optional)"><code>optionally(java.lang.String, java.util.Optional&lt;?&gt;)</code></a> or <a href="#when(boolean,java.lang.String,java.lang.Object...)"><code>when(boolean, java.lang.String, java.lang.Object...)</code></a>),
 returns the SafeSql produced from the <code>fallback</code> template and <code>args</code>.

 <p>Using this method, you can create a chain of optional queries like:

 <pre><code>
 SafeSql.of(
     """
     CREATE TABLE ...
     {cluster_by}
     """,
     when(enableCluster, "CLUSTER BY (`{cluster_columns}`)", clusterColumns)
         .orElse("-- no cluster"));
 </code></pre></div>
<dl class="notes">
<dt>Since:</dt>
<dd>8.3</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="orElse(com.google.mu.safesql.SafeSql)">
<h3>orElse</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a></span>&nbsp;<span class="element-name">orElse</span><wbr><span class="parameters">(<a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a>&nbsp;fallback)</span></div>
<div class="block">If <code>this</code> query is empty (likely from a call to <a href="#optionally(java.lang.String,java.util.Optional)"><code>optionally(java.lang.String, java.util.Optional&lt;?&gt;)</code></a> or <a href="#when(boolean,java.lang.String,java.lang.Object...)"><code>when(boolean, java.lang.String, java.lang.Object...)</code></a>),
 returns the <code>fallback</code> query.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>8.3</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="orElse(java.util.function.Supplier)">
<h3>orElse</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a></span>&nbsp;<span class="element-name">orElse</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/function/Supplier.html" title="class or interface in java.util.function" class="external-link">Supplier</a>&lt;<a href="SafeSql.html" title="class in com.google.mu.safesql">SafeSql</a>&gt;&nbsp;fallback)</span></div>
<div class="block">If <code>this</code> query is empty (likely from a call to <a href="#optionally(java.lang.String,java.util.Optional)"><code>optionally(java.lang.String, java.util.Optional&lt;?&gt;)</code></a> or <a href="#when(boolean,java.lang.String,java.lang.Object...)"><code>when(boolean, java.lang.String, java.lang.Object...)</code></a>),
 returns the query produced by the <code>fallback</code> supplier.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>8.3</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="query(javax.sql.DataSource,java.lang.Class)">
<h3>query</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;T&gt;</span>&nbsp;<span class="element-name">query</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</span></div>
<div class="block">Executes the encapsulated SQL as a query against <code>dataSource.getConnection()</code>.
 The <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link"><code>ResultSet</code></a> will be consumed, transformed to a list of <code>T</code> and then closed before returning.

 <p>For example: <pre><code>
 List&lt;User&gt; users = SafeSql.of("SELECT id, name FROM Users WHERE name LIKE '%{name}%'", name)
     .query(dataSource, User.class);

 record User(long id, String name) {...}
 </code></pre>

 <p>The class of <code>resultType</code> must define a non-private constructor that accepts
 the same number of parameters as returned by the query. The parameter order doesn't
 matter but the parameter <em>names</em> and types must match.

 <p>Note that if you've enabled the <code>-parameters</code> javac flag, the above example code
 will just work. If you can't enable <code>-parameters</code>, consider explicitly annotating
 the constructor parameters as in:

 <pre><code>
 record User(@SqlName("id") long id, @SqlName("name") String name) {...}
 </code></pre>

 <p>Alternatively, if your query only selects one column, you could also use this method
 to read the results: <pre><code>
 List&lt;String&gt; names = SafeSql.of("SELECT name FROM Users WHERE name LIKE '%{name}%'", name)
     .query(dataSource, String.class);
 </code></pre>

 <p>You can also map the result rows to Java Beans, for example: <pre><code>
 List&lt;UserBean&gt; users =
     SafeSql.of("SELECT id, name FROM Users WHERE name LIKE '%{name}%'", name)
         .query(dataSource, UserBean.class);

 public class UserBean {
   public void setId(long id) {...}
   public void setName(String name) {...}
 }
 </code></pre>

 <p>The rules of mapping query columns to Java Bean properties are:
 <ul>
 <li>Case doesn't matter. <code>job_id</code> will match <code>jobId</code> or <code>JOB_ID</code>.
 <li>The column names can be a superset, or a subset of the bean property names.
     This allows you to use "select *" in the query (when performance isn't a concern),
     or use a generic Java bean that may have more properties than some individual queries.
 <li>If a bean property is of primitive type, and the corresponding query column value
     is null, the property will be left as is.
 <li>If you can't make a bean property match a query column, consider annotating the setter
     method with the <code>@SqlName</code> annotation to customize the column name.
 <li>Exception will be thrown if a column doesn't map to a settable property, and the columns
     aren't a superset. For example, you may have renamed a property but forgot to rename the
     corresponding query column. In such case, failing loudly and clearly is safer than letting
     the program silently run with corrupted state.
 </ul></div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="UncheckedSqlException.html" title="class in com.google.mu.safesql">UncheckedSqlException</a></code> - wraps <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link"><code>SQLException</code></a> if failed</dd>
<dt>Since:</dt>
<dd>9.0</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="query(java.sql.Connection,java.lang.Class)">
<h3>query</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;T&gt;</span>&nbsp;<span class="element-name">query</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</span>
                  throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></span></div>
<div class="block">Similar to <a href="#query(javax.sql.DataSource,java.lang.Class)"><code>query(DataSource, Class)</code></a>, but uses an existing connection.

 <p>It's usually more convenient to use the <code>DataSource</code> overload because you won't have
 to manage the JDBC resources. Use this method if you need to reuse a connection
 (mostly for multi-statement transactions).</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></code></dd>
<dt>Since:</dt>
<dd>8.7</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="query(javax.sql.DataSource,com.google.mu.safesql.SqlFunction)">
<h3>query</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;T&gt;</span>&nbsp;<span class="element-name">query</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</span></div>
<div class="block">Executes the encapsulated SQL as a query against <code>dataSource.getConnection()</code>.
 The <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link"><code>ResultSet</code></a> will be consumed, transformed by <code>rowMapper</code> and then closed before returning.

 <p>For example: <pre><code>
 List&lt;Long&gt; ids = SafeSql.of("SELECT id FROM Users WHERE name LIKE '%{name}%'", name)
     .query(dataSource, row -&gt; row.getLong("id"));
 </code></pre>

 <p>Internally it delegates to <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#executeQuery()" title="class or interface in java.sql" class="external-link"><code>PreparedStatement.executeQuery()</code></a> or <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Statement.html#executeQuery(java.lang.String)" title="class or interface in java.sql" class="external-link"><code>Statement.executeQuery(java.lang.String)</code></a> if this sql contains no JDBC binding parameters.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="UncheckedSqlException.html" title="class in com.google.mu.safesql">UncheckedSqlException</a></code> - wraps <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link"><code>SQLException</code></a> if failed</dd>
<dt>Since:</dt>
<dd>9.0</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="query(javax.sql.DataSource,com.google.mu.safesql.StatementSettings,java.lang.Class)">
<h3>query</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;T&gt;</span>&nbsp;<span class="element-name">query</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="StatementSettings.html" title="interface in com.google.mu.safesql">StatementSettings</a>&nbsp;settings,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</span></div>
<div class="block">Similar to <a href="#query(javax.sql.DataSource,java.lang.Class)"><code>query(DataSource, Class)</code></a>, but with <code>settings</code>
 (can be set via lambda like <code>stmt -&gt; stmt.setMaxRows(100)</code>)
 to allow customization.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="UncheckedSqlException.html" title="class in com.google.mu.safesql">UncheckedSqlException</a></code> - wraps <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link"><code>SQLException</code></a> if failed</dd>
<dt>Since:</dt>
<dd>9.0</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="query(java.sql.Connection,com.google.mu.safesql.StatementSettings,java.lang.Class)">
<h3>query</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;T&gt;</span>&nbsp;<span class="element-name">query</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="StatementSettings.html" title="interface in com.google.mu.safesql">StatementSettings</a>&nbsp;settings,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</span>
                  throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></span></div>
<div class="block">Similar to <a href="#query(javax.sql.DataSource,com.google.mu.safesql.StatementSettings,java.lang.Class)"><code>query(DataSource, StatementSettings, Class)</code></a>, but uses an existing connection.

 <p>It's usually more convenient to use the <code>DataSource</code> overload because you won't have
 to manage the JDBC resources. Use this method if you need to reuse a connection
 (mostly for multi-statement transactions).</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></code></dd>
<dt>Since:</dt>
<dd>9.0</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="query(javax.sql.DataSource,com.google.mu.safesql.StatementSettings,com.google.mu.safesql.SqlFunction)">
<h3>query</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;T&gt;</span>&nbsp;<span class="element-name">query</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="StatementSettings.html" title="interface in com.google.mu.safesql">StatementSettings</a>&nbsp;settings,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</span></div>
<div class="block">Executes the encapsulated SQL as a query against <code>dataSource.getConnection()</code>,
 using <code>settings</code> (can be set via lambda like <code>stmt -&gt; stmt.setMaxRows(100)</code>).
 The <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link"><code>ResultSet</code></a> will be consumed, transformed by <code>rowMapper</code> and then closed
 before returning.

 <p>For example: <pre><code>
 List&lt;Long&gt; ids = SafeSql.of("SELECT id FROM Users WHERE name LIKE '%{name}%'", name)
     .query(dataSource, stmt -&gt; stmt.setMaxRows(100000), row -&gt; row.getLong("id"));
 </code></pre>

 <p>Internally it delegates to <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#executeQuery()" title="class or interface in java.sql" class="external-link"><code>PreparedStatement.executeQuery()</code></a> or <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Statement.html#executeQuery(java.lang.String)" title="class or interface in java.sql" class="external-link"><code>Statement.executeQuery(java.lang.String)</code></a> if this sql contains no JDBC binding parameters.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="UncheckedSqlException.html" title="class in com.google.mu.safesql">UncheckedSqlException</a></code> - wraps <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link"><code>SQLException</code></a> if failed</dd>
<dt>Since:</dt>
<dd>9.0</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="query(java.sql.Connection,com.google.mu.safesql.StatementSettings,com.google.mu.safesql.SqlFunction)">
<h3>query</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;T&gt;</span>&nbsp;<span class="element-name">query</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="StatementSettings.html" title="interface in com.google.mu.safesql">StatementSettings</a>&nbsp;settings,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</span>
                  throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></span></div>
<div class="block">Similar to <a href="#query(javax.sql.DataSource,com.google.mu.safesql.StatementSettings,com.google.mu.safesql.SqlFunction)"><code>query(DataSource, StatementSettings, SqlFunction)</code></a>, but uses an existing connection.

 <p>It's usually more convenient to use the <code>DataSource</code> overload because you won't have
 to manage the JDBC resources. Use this method if you need to reuse a connection
 (mostly for multi-statement transactions).

 <p>For example: <pre><code>
 List&lt;Long&gt; ids = SafeSql.of("SELECT id FROM Users WHERE name LIKE '%{name}%'", name)
     .query(connection, stmt -&gt; stmt.setMaxRows(100000), row -&gt; row.getLong("id"));
 </code></pre>

 <p>Internally it delegates to <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#executeQuery()" title="class or interface in java.sql" class="external-link"><code>PreparedStatement.executeQuery()</code></a> or <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Statement.html#executeQuery(java.lang.String)" title="class or interface in java.sql" class="external-link"><code>Statement.executeQuery(java.lang.String)</code></a> if this sql contains no JDBC binding parameters.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></code></dd>
<dt>Since:</dt>
<dd>9.0</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="query(java.sql.Connection,com.google.mu.safesql.SqlFunction)">
<h3>query</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;T&gt;</span>&nbsp;<span class="element-name">query</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</span>
                  throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></span></div>
<div class="block">Similar to <a href="#query(javax.sql.DataSource,com.google.mu.safesql.SqlFunction)"><code>query(DataSource, SqlFunction)</code></a>, but uses an existing connection.

 <p>It's usually more convenient to use the <code>DataSource</code> overload because you won't have
 to manage the JDBC resources. Use this method if you need to reuse a connection
 (mostly for multi-statement transactions).

 <p>For example: <pre><code>
 List&lt;Long&gt; ids = SafeSql.of("SELECT id FROM Users WHERE name LIKE '%{name}%'", name)
     .query(connection, row -&gt; row.getLong("id"));
 </code></pre>

 <p>Internally it delegates to <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#executeQuery()" title="class or interface in java.sql" class="external-link"><code>PreparedStatement.executeQuery()</code></a> or <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Statement.html#executeQuery(java.lang.String)" title="class or interface in java.sql" class="external-link"><code>Statement.executeQuery(java.lang.String)</code></a> if this sql contains no JDBC binding parameters.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></code></dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="queryForOne(javax.sql.DataSource,java.lang.Class)">
<h3>queryForOne</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;T&gt;</span>&nbsp;<span class="element-name">queryForOne</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</span></div>
<div class="block">Similar to <a href="#query(javax.sql.DataSource,java.lang.Class)"><code>query(DataSource, Class)</code></a>, but only fetches one row if the query
 result includes at least one rows, or else returns <code>Optional.empty()</code>.

 <p>Suitable for queries that search by the primary key, for example: <pre><code>
 Optional&lt;User&gt; user =
     SafeSql.of("select id, name from Users where id = {id}", userId)
         .queryForOne(dataSource, User.class);
 </code></pre></div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="UncheckedSqlException.html" title="class in com.google.mu.safesql">UncheckedSqlException</a></code> - wraps <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link"><code>SQLException</code></a> if failed</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/NullPointerException.html" title="class or interface in java.lang" class="external-link">NullPointerException</a></code> - if the first column value is null, and <code>resultType</code>
   isn't a record or Java Bean.</dd>
<dt>Since:</dt>
<dd>9.2</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="queryForOne(java.sql.Connection,java.lang.Class)">
<h3>queryForOne</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;T&gt;</span>&nbsp;<span class="element-name">queryForOne</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</span>
                            throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></span></div>
<div class="block">Similar to <a href="#query(java.sql.Connection,java.lang.Class)"><code>query(Connection, Class)</code></a>, but only fetches one row if the query
 result includes at least one rows, or else returns <code>Optional.empty()</code>.

 <p>Suitable for queries that search by the primary key, for example: <pre><code>
 Optional&lt;User&gt; user =
     SafeSql.of("select id, name from Users where id = {id}", userId)
         .queryForOne(connection, User.class);
 </code></pre></div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/NullPointerException.html" title="class or interface in java.lang" class="external-link">NullPointerException</a></code> - if the first column value is null, and <code>resultType</code>
   isn't a record or Java Bean.</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></code></dd>
<dt>Since:</dt>
<dd>9.2</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="queryForOne(javax.sql.DataSource,com.google.mu.safesql.SqlFunction)">
<h3>queryForOne</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;T&gt;</span>&nbsp;<span class="element-name">queryForOne</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</span></div>
<div class="block">Similar to <a href="#query(javax.sql.DataSource,com.google.mu.safesql.SqlFunction)"><code>query(DataSource, SqlFunction)</code></a>, but only fetches one row if the query
 result includes at least one rows, or else returns <code>Optional.empty()</code>.

 <p>Suitable for queries that search by the primary key.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="UncheckedSqlException.html" title="class in com.google.mu.safesql">UncheckedSqlException</a></code> - wraps <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link"><code>SQLException</code></a> if failed</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/NullPointerException.html" title="class or interface in java.lang" class="external-link">NullPointerException</a></code> - if <code>rowMapper</code> returns null</dd>
<dt>Since:</dt>
<dd>9.2</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="queryForOne(java.sql.Connection,com.google.mu.safesql.SqlFunction)">
<h3>queryForOne</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;T&gt;</span>&nbsp;<span class="element-name">queryForOne</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</span>
                            throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></span></div>
<div class="block">Similar to <a href="#query(java.sql.Connection,com.google.mu.safesql.SqlFunction)"><code>query(Connection, SqlFunction)</code></a>, but only fetches one row if the query
 result includes at least one rows, or else returns <code>Optional.empty()</code>.

 <p>Suitable for queries that search by the primary key.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/NullPointerException.html" title="class or interface in java.lang" class="external-link">NullPointerException</a></code> - if <code>rowMapper</code> returns null</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></code></dd>
<dt>Since:</dt>
<dd>9.2</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="queryLazily(javax.sql.DataSource,java.lang.Class)">
<h3>queryLazily</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations">@MustBeClosed
</span><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link">Stream</a>&lt;T&gt;</span>&nbsp;<span class="element-name">queryLazily</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</span></div>
<div class="block">Executes the encapsulated SQL as a query against <code>connection</code>,
 and then fetches the results lazily in a stream.

 <p>Each result row is transformed into <code>resultType</code>.

 <p>The caller must close it using try-with-resources idiom, which will close the associated
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Statement.html" title="class or interface in java.sql" class="external-link"><code>Statement</code></a> and <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link"><code>ResultSet</code></a>.

 <p>For example: <pre><code>
 SafeSql sql = SafeSql.of("SELECT id, name FROM Users WHERE name LIKE '%{name}%'", name);
 try (Stream&lt;User&gt; users = sql.queryLazily(connection, User.class)) {
   return users.findFirst();
 }

 record User(long id, String name) {...}
 </code></pre>

 <p>The class of <code>resultType</code> must define a non-private constructor that accepts
 the same number of parameters as returned by the query. The parameter order doesn't
 matter but the parameter <em>names</em> and types must match.

 <p>Note that if you've enabled the <code>-parameters</code> javac flag, the above example code
 will just work. If you can't enable <code>-parameters</code>, consider explicitly annotating
 the constructor parameters as in:

 <pre><code>
 record User(@SqlName("id") long id, @SqlName("name") String name) {...}
 </code></pre>

 <p>Alternatively, if your query only selects one column, you could also use this method
 to read the results: <pre><code>
 SafeSql sql = SafeSql.of("SELECT id FROM Users WHERE name LIKE '%{name}%'", name);
 try (Stream&lt;Long&gt; ids = sql.queryLazily(dataSource, Long.class)) {
   return ids.findFirst();
 }
 </code></pre>

 <p>You can also map the result rows to Java Beans, similar to <a href="#query(java.sql.Connection,java.lang.Class)"><code>query(Connection, Class)</code></a>.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="UncheckedSqlException.html" title="class in com.google.mu.safesql">UncheckedSqlException</a></code> - wraps <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link"><code>SQLException</code></a> if failed</dd>
<dt>Since:</dt>
<dd>9.2</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="queryLazily(javax.sql.DataSource,com.google.mu.safesql.SqlFunction)">
<h3>queryLazily</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations">@MustBeClosed
</span><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link">Stream</a>&lt;T&gt;</span>&nbsp;<span class="element-name">queryLazily</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</span></div>
<div class="block">Executes the encapsulated SQL as a query against <code>connection</code>,
 and then fetches the results lazily in a stream.

 <p>The returned <code>Stream</code> includes results transformed by <code>rowMapper</code>.
 The caller must close it using try-with-resources idiom, which will close the associated
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link"><code>Connection</code></a>, <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Statement.html" title="class or interface in java.sql" class="external-link"><code>Statement</code></a> and <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link"><code>ResultSet</code></a>.

 <p>For example: <pre><code>
 SafeSql sql = SafeSql.of("SELECT name FROM Users WHERE name LIKE '%{name}%'", name);
 try (Stream&lt;String&gt; names = sql.queryLazily(dataSource, row -&gt; row.getString("name"))) {
   return names.findFirst();
 }
 </code></pre>

 <p>Internally it delegates to <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#executeQuery()" title="class or interface in java.sql" class="external-link"><code>PreparedStatement.executeQuery()</code></a> or <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Statement.html#executeQuery(java.lang.String)" title="class or interface in java.sql" class="external-link"><code>Statement.executeQuery(java.lang.String)</code></a> if this sql contains no JDBC binding parameters.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="UncheckedSqlException.html" title="class in com.google.mu.safesql">UncheckedSqlException</a></code> - wraps <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link"><code>SQLException</code></a> if failed</dd>
<dt>Since:</dt>
<dd>9.2</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="queryLazily(javax.sql.DataSource,com.google.mu.safesql.StatementSettings,java.lang.Class)">
<h3>queryLazily</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations">@MustBeClosed
</span><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link">Stream</a>&lt;T&gt;</span>&nbsp;<span class="element-name">queryLazily</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="StatementSettings.html" title="interface in com.google.mu.safesql">StatementSettings</a>&nbsp;settings,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</span></div>
<div class="block">Executes the encapsulated SQL as a query against <code>connection</code>, with <code>settings</code>
 (can be set via lambda like <code>stmt -&gt; stmt.setFetchSize(100)</code>), and then fetches the
 results lazily in a stream.

 <p>Each result row is transformed into <code>resultType</code>.

 <p>For example: <pre><code>
 SafeSql sql = SafeSql.of("SELECT name FROM Users WHERE name LIKE '%{name}%'", name);
 try (Stream&lt;String&gt; names = sql.queryLazily(
     dataSource, stmt -&gt; stmt.setFetchSize(100), String.class)) {
   return names.findFirst();
 }
 </code></pre>

 <p>Internally it delegates to <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#executeQuery()" title="class or interface in java.sql" class="external-link"><code>PreparedStatement.executeQuery()</code></a> or <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Statement.html#executeQuery(java.lang.String)" title="class or interface in java.sql" class="external-link"><code>Statement.executeQuery(java.lang.String)</code></a> if this sql contains no JDBC binding parameters.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="UncheckedSqlException.html" title="class in com.google.mu.safesql">UncheckedSqlException</a></code> - wraps <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link"><code>SQLException</code></a> if failed</dd>
<dt>Since:</dt>
<dd>9.2</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="queryLazily(javax.sql.DataSource,com.google.mu.safesql.StatementSettings,com.google.mu.safesql.SqlFunction)">
<h3>queryLazily</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations">@MustBeClosed
</span><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link">Stream</a>&lt;T&gt;</span>&nbsp;<span class="element-name">queryLazily</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="StatementSettings.html" title="interface in com.google.mu.safesql">StatementSettings</a>&nbsp;settings,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</span></div>
<div class="block">Executes the encapsulated SQL as a query against <code>dataSource</code>, with <code>settings</code>
 (can be set via lambda like <code>stmt -&gt; stmt.setFetchSize(100)</code>, and then fetches the
 results lazily in a stream.

 <p>The returned <code>Stream</code> includes results transformed by <code>rowMapper</code>.
 The caller must close it using try-with-resources idiom, which will close the associated
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link"><code>Connection</code></a>, <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Statement.html" title="class or interface in java.sql" class="external-link"><code>Statement</code></a> and <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link"><code>ResultSet</code></a>.

 <p>For example: <pre><code>
 SafeSql sql = SafeSql.of("SELECT name FROM Users WHERE name LIKE '%{name}%'", name);
 try (Stream&lt;String&gt; names = sql.queryLazily(
     dataSource, stmt -&gt; stmt.setFetchSize(100), row -&gt; row.getString("name"))) {
   return names.findFirst();
 }
 </code></pre>

 <p>Internally it delegates to <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#executeQuery()" title="class or interface in java.sql" class="external-link"><code>PreparedStatement.executeQuery()</code></a> or <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Statement.html#executeQuery(java.lang.String)" title="class or interface in java.sql" class="external-link"><code>Statement.executeQuery(java.lang.String)</code></a> if this sql contains no JDBC binding parameters.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="UncheckedSqlException.html" title="class in com.google.mu.safesql">UncheckedSqlException</a></code> - wraps <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link"><code>SQLException</code></a> if failed</dd>
<dt>Since:</dt>
<dd>9.2</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="queryLazily(java.sql.Connection,java.lang.Class)">
<h3>queryLazily</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations">@MustBeClosed
</span><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link">Stream</a>&lt;T&gt;</span>&nbsp;<span class="element-name">queryLazily</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</span>
                          throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></span></div>
<div class="block">Executes the encapsulated SQL as a query against <code>connection</code>,
 and then fetches the results lazily in a stream.

 <p>Each result row is transformed into <code>resultType</code>.

 <p>The caller must close it using try-with-resources idiom, which will close the associated
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Statement.html" title="class or interface in java.sql" class="external-link"><code>Statement</code></a> and <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link"><code>ResultSet</code></a>.

 <p>For example: <pre><code>
 SafeSql sql = SafeSql.of("SELECT id, name FROM Users WHERE name LIKE '%{name}%'", name);
 try (Stream&lt;User&gt; users = sql.queryLazily(connection, User.class)) {
   return users.findFirst();
 }

 record User(long id, String name) {...}
 </code></pre>

 <p>The class of <code>resultType</code> must define a non-private constructor that accepts
 the same number of parameters as returned by the query. The parameter order doesn't
 matter but the parameter <em>names</em> and types must match.

 <p>Note that if you've enabled the <code>-parameters</code> javac flag, the above example code
 will just work. If you can't enable <code>-parameters</code>, consider explicitly annotating
 the constructor parameters as in:

 <pre><code>
 record User(@SqlName("id") long id, @SqlName("name") String name) {...}
 </code></pre>

 <p>Alternatively, if your query only selects one column, you could also use this method
 to read the results: <pre><code>
 SafeSql sql = SafeSql.of("SELECT id FROM Users WHERE name LIKE '%{name}%'", name);
 try (Stream&lt;Long&gt; ids = sql.queryLazily(connection, Long.class)) {
   return ids.findFirst();
 }
 </code></pre>

 <p>You can also map the result rows to Java Beans, similar to <a href="#query(java.sql.Connection,java.lang.Class)"><code>query(Connection, Class)</code></a>.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></code></dd>
<dt>Since:</dt>
<dd>8.7</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="queryLazily(java.sql.Connection,com.google.mu.safesql.SqlFunction)">
<h3>queryLazily</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations">@MustBeClosed
</span><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link">Stream</a>&lt;T&gt;</span>&nbsp;<span class="element-name">queryLazily</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</span>
                          throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></span></div>
<div class="block">Executes the encapsulated SQL as a query against <code>connection</code>,
 and then fetches the results lazily in a stream.

 <p>The returned <code>Stream</code> includes results transformed by <code>rowMapper</code>.
 The caller must close it using try-with-resources idiom, which will close the associated
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Statement.html" title="class or interface in java.sql" class="external-link"><code>Statement</code></a> and <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link"><code>ResultSet</code></a>.

 <p>For example: <pre><code>
 SafeSql sql = SafeSql.of("SELECT name FROM Users WHERE name LIKE '%{name}%'", name);
 try (Stream&lt;String&gt; names = sql.queryLazily(connection, row -&gt; row.getString("name"))) {
   return names.findFirst();
 }
 </code></pre>

 <p>Internally it delegates to <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#executeQuery()" title="class or interface in java.sql" class="external-link"><code>PreparedStatement.executeQuery()</code></a> or <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Statement.html#executeQuery(java.lang.String)" title="class or interface in java.sql" class="external-link"><code>Statement.executeQuery(java.lang.String)</code></a> if this sql contains no JDBC binding parameters.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></code></dd>
<dt>Since:</dt>
<dd>8.4</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="queryLazily(java.sql.Connection,com.google.mu.safesql.StatementSettings,java.lang.Class)">
<h3>queryLazily</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations">@MustBeClosed
</span><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link">Stream</a>&lt;T&gt;</span>&nbsp;<span class="element-name">queryLazily</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="StatementSettings.html" title="interface in com.google.mu.safesql">StatementSettings</a>&nbsp;settings,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</span>
                          throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></span></div>
<div class="block">Executes the encapsulated SQL as a query against <code>connection</code>, with <code>settings</code>
 (can be set via lambda like <code>stmt -&gt; stmt.setFetchSize(100)</code>), and then fetches the
 results lazily in a stream.

 <p>Each result row is transformed into <code>resultType</code>.

 <p>For example: <pre><code>
 SafeSql sql = SafeSql.of("SELECT name FROM Users WHERE name LIKE '%{name}%'", name);
 try (Stream&lt;String&gt; names = sql.queryLazily(
     connection, stmt -&gt; stmt.setFetchSize(100), String.class)) {
   return names.findFirst();
 }
 </code></pre>

 <p>Internally it delegates to <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#executeQuery()" title="class or interface in java.sql" class="external-link"><code>PreparedStatement.executeQuery()</code></a> or <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Statement.html#executeQuery(java.lang.String)" title="class or interface in java.sql" class="external-link"><code>Statement.executeQuery(java.lang.String)</code></a> if this sql contains no JDBC binding parameters.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></code></dd>
<dt>Since:</dt>
<dd>9.0</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="queryLazily(java.sql.Connection,com.google.mu.safesql.StatementSettings,com.google.mu.safesql.SqlFunction)">
<h3>queryLazily</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations">@MustBeClosed
</span><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link">Stream</a>&lt;T&gt;</span>&nbsp;<span class="element-name">queryLazily</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="StatementSettings.html" title="interface in com.google.mu.safesql">StatementSettings</a>&nbsp;settings,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</span>
                          throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></span></div>
<div class="block">Executes the encapsulated SQL as a query against <code>connection</code>, with <code>settings</code>
 (can be set via lambda like <code>stmt -&gt; stmt.setFetchSize(100)</code>, and then fetches the
 results lazily in a stream.

 <p>The returned <code>Stream</code> includes results transformed by <code>rowMapper</code>.
 The caller must close it using try-with-resources idiom, which will close the associated
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Statement.html" title="class or interface in java.sql" class="external-link"><code>Statement</code></a> and <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link"><code>ResultSet</code></a>.

 <p>For example: <pre><code>
 SafeSql sql = SafeSql.of("SELECT name FROM Users WHERE name LIKE '%{name}%'", name);
 try (Stream&lt;String&gt; names = sql.queryLazily(
     connection, stmt -&gt; stmt.setFetchSize(100), row -&gt; row.getString("name"))) {
   return names.findFirst();
 }
 </code></pre>

 <p>Internally it delegates to <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#executeQuery()" title="class or interface in java.sql" class="external-link"><code>PreparedStatement.executeQuery()</code></a> or <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Statement.html#executeQuery(java.lang.String)" title="class or interface in java.sql" class="external-link"><code>Statement.executeQuery(java.lang.String)</code></a> if this sql contains no JDBC binding parameters.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></code></dd>
<dt>Since:</dt>
<dd>9.0</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="update(javax.sql.DataSource)">
<h3>update</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations">@CanIgnoreReturnValue
</span><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">update</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource)</span></div>
<div class="block">Executes the encapsulated DML (create, update, delete statements) against <code>dataSource</code>
 and returns the number of affected rows.

 <p>For example: <pre><code>
 SafeSql.of("INSERT INTO Users(id, name) VALUES({id}, '{name}')", id, name)
     .update(dataSource);
 </code></pre>

 <p>Internally it delegates to <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#executeUpdate()" title="class or interface in java.sql" class="external-link"><code>PreparedStatement.executeUpdate()</code></a>.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="UncheckedSqlException.html" title="class in com.google.mu.safesql">UncheckedSqlException</a></code> - wraps <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link"><code>SQLException</code></a> if failed</dd>
<dt>Since:</dt>
<dd>9.2</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="update(javax.sql.DataSource,com.google.mu.safesql.StatementSettings)">
<h3>update</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations">@CanIgnoreReturnValue
</span><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">update</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/javax/sql/DataSource.html" title="class or interface in javax.sql" class="external-link">DataSource</a>&nbsp;dataSource,
 <a href="StatementSettings.html" title="interface in com.google.mu.safesql">StatementSettings</a>&nbsp;settings)</span></div>
<div class="block">Similar to <a href="#update(javax.sql.DataSource)"><code>update(DataSource)</code></a>, but with <code>settings</code>
 (can be set via lambda like <code>stmt -&gt; stmt.setQueryTimeout(100)</code>)
 to allow customization.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="UncheckedSqlException.html" title="class in com.google.mu.safesql">UncheckedSqlException</a></code> - wraps <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link"><code>SQLException</code></a> if failed</dd>
<dt>Since:</dt>
<dd>9.2</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="update(java.sql.Connection)">
<h3>update</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations">@CanIgnoreReturnValue
</span><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">update</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection)</span>
           throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></span></div>
<div class="block">Executes the encapsulated DML (create, update, delete statements) against <code>connection</code>
 and returns the number of affected rows.

 <p>For example: <pre><code>
 SafeSql.of("INSERT INTO Users(id, name) VALUES({id}, '{name}')", id, name)
     .update(connection);
 </code></pre>

 <p>Internally it delegates to <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#executeUpdate()" title="class or interface in java.sql" class="external-link"><code>PreparedStatement.executeUpdate()</code></a>.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></code></dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="update(java.sql.Connection,com.google.mu.safesql.StatementSettings)">
<h3>update</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations">@CanIgnoreReturnValue
</span><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">update</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 <a href="StatementSettings.html" title="interface in com.google.mu.safesql">StatementSettings</a>&nbsp;settings)</span>
           throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></span></div>
<div class="block">Similar to <a href="#update(java.sql.Connection)"><code>update(Connection)</code></a>, but with <code>settings</code>
 (can be set via lambda like <code>stmt -&gt; stmt.setQueryTimeout(100)</code>)
 to allow customization.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></code></dd>
<dt>Since:</dt>
<dd>9.0</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="prepareStatement(java.sql.Connection)">
<h3>prepareStatement</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations">@MustBeClosed
</span><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html" title="class or interface in java.sql" class="external-link">PreparedStatement</a></span>&nbsp;<span class="element-name">prepareStatement</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection)</span>
                                   throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></span></div>
<div class="block">Returns a <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html" title="class or interface in java.sql" class="external-link"><code>PreparedStatement</code></a> with the encapsulated sql and parameters.

 <p>It's often more convenient to use <a href="#query(javax.sql.DataSource,java.lang.Class)"><code>query(javax.sql.DataSource, java.lang.Class&lt;? extends T&gt;)</code></a> or <a href="#update(javax.sql.DataSource)"><code>update(javax.sql.DataSource)</code></a> unless you need to
 directly operate on the PreparedStatement.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></code></dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="prepareToQuery(java.sql.Connection,java.lang.String,java.lang.Class)">
<h3>prepareToQuery</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="../util/StringFormat.Template.html" title="interface in com.google.mu.util">StringFormat.Template</a>&lt;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;T&gt;&gt;</span>&nbsp;<span class="element-name">prepareToQuery</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 @CompileTimeConstant
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;template,
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends T&gt;&nbsp;resultType)</span></div>
<div class="block">Returns a query template that will reuse the same cached <code>PreparedStatement</code>
 for repeated calls of <a href="../util/StringFormat.Template.html#with(java.lang.Object...)"><code>StringFormat.Template.with(java.lang.Object...)</code></a> using different parameters.

 <p>Allows callers to take advantage of the performance benefit of PreparedStatement
 without having to re-create the statement for each call. For example in: <pre><code>
   try (var connection = ...) {
     var queryByName = SafeSql.prepareToQuery(
         connection, "SELECT id, name FROM Users WHERE name LIKE '%{name}%'",
         User.class);
     for (String name : names) {
       for (User user : queryByName.with(name))) {
         ...
       }
     }
   }

   record User(long id, String name) {...}
 </code></pre>

 Each time <code>queryByName.with(name)</code> is called, it executes the same query template
 against the connection, but with a different <code>name</code> parameter. Internally it reuses the
 cached PreparedStatement object and just calls <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#setObject(int,java.lang.Object)" title="class or interface in java.sql" class="external-link"><code>PreparedStatement.setObject(int, Object)</code></a>
 with the new set of parameters before calling <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#executeQuery()" title="class or interface in java.sql" class="external-link"><code>PreparedStatement.executeQuery()</code></a>.

 <p>The template arguments follow the same rules as discussed in <a href="#of(java.lang.String,java.lang.Object...)"><code>of(String, Object...)</code></a>
 and receives the same compile-time protection against mismatch or out-of-order human mistakes.

 <p>The returned Template is <em>not</em> thread safe.

 <p>The caller is expected to close the <code>connection</code> after done, which will close the
 cached PreparedStatement. The <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link"><code>ResultSet</code></a> objects are guaranteed to be closed after each use
 before the PreparedStatement is closed.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>8.7</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="prepareToQuery(java.sql.Connection,java.lang.String,com.google.mu.safesql.SqlFunction)">
<h3>prepareToQuery</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="../util/StringFormat.Template.html" title="interface in com.google.mu.util">StringFormat.Template</a>&lt;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;T&gt;&gt;</span>&nbsp;<span class="element-name">prepareToQuery</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 @CompileTimeConstant
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;template,
 <a href="SqlFunction.html" title="interface in com.google.mu.safesql">SqlFunction</a>&lt;? super <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link">ResultSet</a>, ? extends T&gt;&nbsp;rowMapper)</span></div>
<div class="block">Returns a query template that will reuse the same cached <code>PreparedStatement</code>
 for repeated calls of <a href="../util/StringFormat.Template.html#with(java.lang.Object...)"><code>StringFormat.Template.with(java.lang.Object...)</code></a> using different parameters.

 <p>Allows callers to take advantage of the performance benefit of PreparedStatement
 without having to re-create the statement for each call. For example in: <pre><code>
   try (var connection = ...) {
     var queryByName = SafeSql.prepareToQuery(
         connection, "SELECT id FROM Users WHERE name LIKE '%{name}%'",
         row -&gt; row.getLong("id"));
     for (String name : names) {
       for (long id : queryByName.with(name))) {
         ...
       }
     }
   }
 </code></pre>

 Each time <code>queryByName.with(name)</code> is called, it executes the same query template
 against the connection, but with a different <code>name</code> parameter. Internally it reuses the
 cached PreparedStatement object and just calls <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#setObject(int,java.lang.Object)" title="class or interface in java.sql" class="external-link"><code>PreparedStatement.setObject(int, Object)</code></a>
 with the new set of parameters before calling <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#executeQuery()" title="class or interface in java.sql" class="external-link"><code>PreparedStatement.executeQuery()</code></a>.

 <p>The template arguments follow the same rules as discussed in <a href="#of(java.lang.String,java.lang.Object...)"><code>of(String, Object...)</code></a>
 and receives the same compile-time protection against mismatch or out-of-order human mistakes.

 <p>The returned Template is <em>not</em> thread safe.

 <p>The caller is expected to close the <code>connection</code> after done, which will close the
 cached PreparedStatement. The <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/ResultSet.html" title="class or interface in java.sql" class="external-link"><code>ResultSet</code></a> objects are guaranteed to be closed after each use
 before the PreparedStatement is closed.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="prepareToUpdate(java.sql.Connection,java.lang.String)">
<h3>prepareToUpdate</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="../util/StringFormat.Template.html" title="interface in com.google.mu.util">StringFormat.Template</a>&lt;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&gt;</span>&nbsp;<span class="element-name">prepareToUpdate</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 @CompileTimeConstant
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;template)</span></div>
<div class="block">Returns a DML (create, update, delete) template that will reuse the same cached <code>
 PreparedStatement</code> for repeated calls of <a href="../util/StringFormat.Template.html#with(java.lang.Object...)"><code>StringFormat.Template.with(java.lang.Object...)</code></a> using different parameters.

 <p>Allows callers to take advantage of the performance benefit of PreparedStatement
 without having to re-create the statement for each call. For example in: <pre><code>
   try (var connection = ...) {
     var insertUser = SafeSql.prepareToUpdate(
         connection, "INSERT INTO Users(id, name) VALUES({id}, '{name}')");
     int totalRowsAffected = insertUser.with(1, "Tom") + insertUser.with(2, "Emma");
   }
 </code></pre>

 Each time <code>insertUser.with(...)</code> is called, it executes the same DML template
 against the connection, but with different <code>id</code> and <code>name</code> parameters.
 Internally it reuses the cached PreparedStatement object and just calls <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#setObject(int,java.lang.Object)" title="class or interface in java.sql" class="external-link"><code>PreparedStatement.setObject(int, Object)</code></a> with the new set of parameters before calling
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#executeUpdate()" title="class or interface in java.sql" class="external-link"><code>PreparedStatement.executeUpdate()</code></a>.

 <p>The template arguments follow the same rules as discussed in <a href="#of(java.lang.String,java.lang.Object...)"><code>of(String, Object...)</code></a>
 and receives the same compile-time protection against mismatch or out-of-order human mistakes.

 <p>The returned Template is <em>not</em> thread safe because the cached <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html" title="class or interface in java.sql" class="external-link"><code>PreparedStatement</code></a> objects aren't.

 <p>The caller is expected to close the <code>connection</code> after done, which will close the
 cached PreparedStatement.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="prepareToBatch(java.sql.Connection,java.lang.String)">
<h3>prepareToBatch</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="../util/StringFormat.Template.html" title="interface in com.google.mu.util">StringFormat.Template</a>&lt;<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html" title="class or interface in java.sql" class="external-link">PreparedStatement</a>&gt;</span>&nbsp;<span class="element-name">prepareToBatch</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/Connection.html" title="class or interface in java.sql" class="external-link">Connection</a>&nbsp;connection,
 @CompileTimeConstant
 <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;template)</span></div>
<div class="block">Returns a DML (create, update, delete) template that will reuse the same cached <code>
 PreparedStatement</code> for repeated calls of <a href="../util/StringFormat.Template.html#with(java.lang.Object...)"><code>StringFormat.Template.with(java.lang.Object...)</code></a> to add <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html#addBatch()" title="class or interface in java.sql" class="external-link"><code>batches</code></a>

 <p>The caller typically uses <a href="../util/StringFormat.Template.html#with(java.lang.Object...)"><code>with(...)</code></a> in a loop.
 After all batches have been added, call <code>executeBatch()</code>, <code>executeLargeBatch()</code> or
 friends on the returned <code>PreparedStatement</code> instance(s).

 <p>Note that if you pass in different subquery or identifier parameters, a distinct
 PreparedStatement object will be returned, each holding a separate batch of commands.
 You can store them in a <code>Set&lt;PreparedStatement&gt;</code> and call <code>executeBatch()</code>
 on all of them. For example in: <pre><code>
   try (var connection = ...) {
     var insertUser = SafeSql.prepareToBatch(
         connection, "INSERT INTO Users(id, name) VALUES({user_id}, '{user_name}')");
     Set&lt;Statement&gt; batches = users.stream()
         .map(user -&gt; insertUser.with(user.id(), user.name()))
         .collect(toUnmodifiableSet());
     for (Statement batch : batches) {  // 0 or 1 batch in `batches`
       batch.executeBatch();
     }
   }
 </code></pre>

 <p>The template arguments follow the same rules as discussed in <a href="#of(java.lang.String,java.lang.Object...)"><code>of(String, Object...)</code></a>
 and receives the same compile-time protection against mismatch or out-of-order human mistakes.

 <p>The returned Template is <em>not</em> thread safe because the cached <a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.sql/java/sql/PreparedStatement.html" title="class or interface in java.sql" class="external-link"><code>PreparedStatement</code></a> objects aren't.

 <p>The caller is expected to close the <code>connection</code> after done, which will close the
 cached PreparedStatement.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>9.5</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="debugString()">
<h3>debugString</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">debugString</span>()</div>
<div class="block">Returns a query string with the parameter values embedded for easier debugging (logging,
 testing, golden file etc.). DO NOT use it as the production SQL query because embedding the
 parameter values isn't safe from SQL injection.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>9.0</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="args()">
<h3>args</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>[]</span>&nbsp;<span class="element-name">args</span>()</div>
<div class="block">Returns a copy of the JDBC arguments. If you need to call Spring JdbcTemplate, consider
 <code>jdbcTemplate.query(safeSql.toString(), safeSql.args())</code>.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>9.6</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="toString()">
<h3>toString</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">toString</span>()</div>
<div class="block">Returns the SQL text with the template parameters translated to the JDBC <code>'?'</code>
 placeholders.</div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a></code>&nbsp;in class&nbsp;<code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></code></dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="hashCode()">
<h3>hashCode</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">hashCode</span>()</div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a></code>&nbsp;in class&nbsp;<code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></code></dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="equals(java.lang.Object)">
<h3>equals</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">equals</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;obj)</span></div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a></code>&nbsp;in class&nbsp;<code><a href="https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></code></dd>
</dl>
</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2024. All rights reserved.</small></p>
</footer>
</main>
</div>
</body>
</html>
